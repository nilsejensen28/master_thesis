\setchapterpreamble[u]{\margintoc}
\chapter{Reducing \Tarski\ to \EOPL}

In the previous chapter, we demonstrated how one can prove the membership of \Tarski\ in \PPAD\ through a reduction to \Sperner. We now demonstrate that the same approach yields a reduction to \EndOfPotentialLine, which lies within \EOPL. This will necessitate a more meticulous examination of the structure of a \Tarski\ instance and the induced colouring of the lattice points. In order to achieve our objective, we must first construct a specific simplical decomposition of the lattice. We do this with the intention of obtaining certain useful properties. Ultimately, our goal is to demonstrate that for a monotone \Tarski\ instance, the associated \EndOfLine\ instance does not contain any cycles. This will prove sufficient to establish a reduction to \EndOfPotentialLine.

\section{Choosing a simplicial decomposition of the lattice --- Freudenthal's Simplical Decomposition}[Freudenthal's Simplical Decomposition]
\label{sec:freudenthal_simplicial_decomposition}

In the previous chapter, we left the choice of a specific simplicial decomposition of the lattice open, as it did not contribute to our reduction. In this chapter, we aim to be more precise in our approach by selecting a specific simplicial decomposition that will enable us to derive structural results. We begin by outlining the desired properties of our simplicial decomposition. The most fundamental property is that every simplex of the decomposition must be contained within a single cell of the lattice. This implies that we can limit our inquiry to the identification of a simplical decomposition of a single $d$-dimensional hypercube of side-length $1$. Additionally, it is important to note that our objective does not entail the introduction of any new vertices; instead, we seek a decomposition of the hypercube that can be expressed as a set of subsets of the hypercube's vertices.	Finally, we which for the vertices of a given simplex be totally ordered with respect to the partial order defined in \cref{sec:tarski_problem}. This will allow us to argue that two vertices, inside a given simplex, are always comparable, and thus their images through $f$ must also be comparable, which will be useful.

Such a decomposition exists, and is known in the litterature as \textit{Freudenthal's simplical decomposition} \sidecite{freudenthal_simplizialzerlegungen_1942}. We will introduce it in a combinatorial way here, and refer the reader to the original paper for a geometric construction of the same decomposition.

\begin{definition}[Freudenthal's Simplicial Decomposition]
	\label[definition]{def:freudenthal_simplicial_decomposition}
	Consider a unit hypercube $[0, 1]^d$ in $\R^d$ and consider $S_d$ the group of all permutations of the dimensions of the hypercube $\{1, \dots, d\}$. For every permutation $\pi \in S_d$, define the simplex $S_{\pi}$ as the convex hull of the vertices:
	\marginnote[10mm]{Here we will use the notation $e_i$ to denote the $i$-th \define{unit vector} in $\R^d$.}
	\begin{align*}
		v_0 & = (0, 0, \dots, 0)                        \\
		v_1 & = v_0 + e_{\pi(1)}                        \\
		v_2 & = v_1 + e_{\pi(2)}                        \\
		    & \vdots                                    \\
		v_d & = v_{d-1} + e_{\pi(d)} = (1, 1, \dots, 1)
	\end{align*}
	The set of such simplexes $\mathcal{S} = \set{S_{\pi} : \pi \in S_d}$ is Freudenthal's simplicial decomposition of the hypercube $[0, 1]^d$.
\end{definition}
We want to begin by arguing why this decomposition is well-defined. We begin by showing that every point of the hypercube is contained in at least one simplex of $\mathcal{S}$.
\begin{lemma}
	\label{lem:caracterisation_of_simplices}
	Let $x = (x[1], \dots, x[d]) \in [0, 1]^d$, let $\pi \in S^d$ be the permutation such that $x[\pi(1)] \leq x[\pi(2)] \leq \dots \leq x[\pi(d)]$. Then $x \in S_{\pi}$.
\end{lemma}
\begin{proof}
	We want to show that $x$ is a convex combination of the vertices of $S_{\pi}$. We define the following sequence of real numbers:
	\begin{align*}
		\lambda_0     & = x[\pi(1)]               \\
		\lambda_1     & = x[\pi(2)] - x[\pi(1)]   \\
		\lambda_2     & = x[\pi(3)] - x[\pi(2)]   \\
		              & \vdots                    \\
		\lambda_{d-1} & = x[\pi(d)] - x[\pi(d-1)] \\
		\lambda_d     & = 1 - x[\pi(d)]
	\end{align*}
	Notice that we have $\lambda_i \geq 0$ for all $i$ and $\sum_{i=0}^{d} \lambda_i = 1$, by telescoping the sum. We can now write $x$ as a convex combination of the vertices of $S_{\pi}$ as follows by noticing that $v_i = \sum_{j=0}^{i} e_{\pi(j)}$:
	\begin{align*}
		\sum_{i=0}^{d} \lambda_i v_i & = \sum_{i=0}^{d} \lambda_i \left( \sum_{j=0}^{i} e_{\pi(j)} \right)  = \sum_{i=0}^{d} \sum_{j=1}^{i} \lambda_i e_{\pi(j)}                                \\
		                             & = \sum_{j=1}^{d} \sum_{i=0}^{j} \lambda_i e_{\pi(j)}  = \sum_{j=1}^{d} e_{\pi(j)} \sum_{i=0}^{j} \lambda_i		 = \sum_{j=1}^{d} e_{\pi(j)} x[\pi(j)]		     = x
	\end{align*}
	This shows that $x$ is a convex combination of the vertices of $S_{\pi}$, and thus $x \in S_{\pi}$.
\end{proof}
Next we discuss why this really forms a partition of the hypercube. Of course a given point $x$ can be contained in multiple simplexes, but we want to show that this does not happen appart from on the boundary of the simplices.
\begin{lemma}
	Let $S_{\pi} \in \mathcal{S}$ be a simplex. Then the \define{interior} of $S_{\pi}$ is:
	\begin{align*}
		\interior{S_{\pi}} = \set{x \in [0, 1]^d : 0 < x[\pi(1)] < x[\pi(2)] < \dots < x[\pi(d)] < 1}
	\end{align*}
\end{lemma}
\begin{proof}
	The same proof as for lemma \ref{lem:caracterisation_of_simplices}, holds with the added constraint that all $\lambda_i > 0$, this then shows that these points are in the interior of the simplex.
\end{proof}
These two Lemmata together show that we have a well-defined simplicial decomposition of the hypercube. We can now use this decomposition to prove some structural results about the lattice points of a \Tarski\ instance. We start by showing that this simplicial decomposition has the desired properties.
\begin{lemma}
	Let $S_{\pi} \in \mathcal{S}$ be a simplex. Then the vertices of $S_{\pi}$ are totally ordered with respect to the partial order defined in \cref{sec:tarski_problem}. In particular we claim that:
	\begin{align*}
		v_0 < v_1 < v_2 < \dots < v_d
	\end{align*}
\end{lemma}
\begin{proof}
	Because this relation is transitive it suffice to show that $v_i < v_{i+1}$ for all $i \in \set{0, \dots, d-1}$. This follows immediately from the construction of the $v_i$ as we have $v_i[j] = v_{i+1}[j]$ for all $j \neq \pi(i+1)$ and $v_i[\pi(i+1)] = v_{i+1}[\pi(i+1)] - 1$.
\end{proof}
This directly implies the following corollary.
\begin{corollary}
	\label{cor:total_ordering}
	For two vertices $x,y$ of any simplex $S \in \mathcal{S}$, if for any $i \in \set{1, \dots, d}$ we have $x[i] < y[i]$, then $x < y$. In particular $x \not\leq y$ is equivalent to $x > y$.
\end{corollary}
Notice that this is not the case for any two points in the hypercube, as the partial order is not a total order. This is why choosing a simplicial decomposition with this property will be crucial in the following sections. Next we want to introduce a new notation which will allow us describe these simplices more succinctly. Assume that a permutation $\pi$ of the dimensions, induces a simplex $S_{\pi}$, with vertices $v_0, \dots, v_d$, as defined in \cref{def:freudenthal_simplicial_decomposition}. Then we will denote the $d$-dimensional simplex $S_{\pi}$ as:
\begin{align*}
	v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d)} v_d
\end{align*}
This notation means that we obtain $v_i$ by moving by one unit-length in the direction $\pi(i)$ from $v_{i-1}$. We already briefly discussed how the faces of a given simplex are given. We will also describe how to describe these faces in our notation. We will denote the face of $S_{\pi}$ obtained by removing the vertex $v_i$ as:
\begin{align*}
	v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots v_{i-1} \xrightarrow{\pi(i), \pi(i+1)} v_{i+1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
\end{align*}

We can remark the following about the faces of a simplex.
\begin{remark}
	\label[remark]{rem:faces_of_simplex}
	For a given $d-1$ dimensional simplex $F$ in $\mathcal{S}$ we have that:
	\marginnote[0mm]{Notice that the case \ref{rem:face_inside_cell} is the case where the face is inside the cell, and the case \ref{rem:face_border_cell} is the case where the face is on the border of the cell.}
	\begin{enumerate}
		\item If $F$ is of the form:
		      \begin{align*}
			      F: \quad v_0 \xrightarrow{\pi(1)}  \cdots v_{i-1} \xrightarrow{\pi(i), \pi(i+1)} v_{i+1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		      \end{align*}
		      Then $F$ is a face of exactly two simplices $S_1$ and $S_2$:
		      \begin{align*}
			      S_1: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i+1)} w_i \xrightarrow{\pi(i)} v_{i} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d  \\
			      S_2: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i)} w_i' \xrightarrow{\pi(i+1)} v_{i} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		      \end{align*}
		      \label{rem:face_inside_cell}
		\item If $F$ is of the form:
		      \begin{align*}
			      F: \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots  \xrightarrow{\pi(d-1)} v_{d-1}
		      \end{align*}
		      Then $F$ is a face of exactly two simplices $S_1$ and $S_2$:
		      \begin{align*}
			      S_1: & \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \xrightarrow{\pi(d)} w_d \\
			      S_2: & \quad w_0 \xrightarrow{\pi(d)} v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \\
		      \end{align*}
		      \label{rem:face_border_cell}
	\end{enumerate}
\end{remark}

We discuss what simplices of the decomposition neighbour each other. We claim that a given simplex has $d-1$ neighbooring simplices inside a given cell, and two neighbooring simplices in neighbooring cells. More precisely we have the following lemma.

\begin{lemma}[Neighbooring Simplices]
	Let $S_{\pi} \in \mathcal{S}$ be a simplex:
	\begin{align*}
		v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d)} v_d
	\end{align*}
	Then the following simplices are neighboors of $S_{\pi}$:
	\begin{itemize}
		\item $v_0 \xrightarrow{\pi(2)} v_1 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i+1)} w_i \xrightarrow{\pi(i+1)} v_{i} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d$, for all $i \in \set{1, \dots, d-1}$, where $w_i$ is the vertex obtained by moving one unit in the direction $\pi(i+1)$ from $v_{i-1}$.
		\item $w_d \xrightarrow{\pi(d)} v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1}$, where $w_d$ is the vertex obtained by moving one unit in the direction $-\pi(d)$ from $v_{0}$.
		\item $v_2 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \xrightarrow{\pi(d)} v_d \xrightarrow{\pi(1)} w_1$, where $w_1$ is the vertex obtained by moving one unit in the direction $\pi(1)$ from $v_d$.
	\end{itemize}
\end{lemma}
\begin{proof}
	The proof follows directly by enumerating the faces of $S_{\pi}$ and using remark \ref{rem:faces_of_simplex}.
\end{proof}

\section{Warmup: No cycles in two-dimensional \Tarskistar-instances}[No cycles in two dimensions]

The aim of this chapter is to prove that there are no cycles in the \EndOfLine\ instances that result from the reduction of monotone \Tarskistar-instances onto \EndOfLine we presented in \cref{sec:sperner_eol_reduction}. We will do this by studying the \Sperner\ instances, and showing that the sequence of simplices that form the lines of the \EndOfLine-instances, cannot form a cycle if the underlying function $f$ is monotone.

Proving this will be a somewhat involed in the general $d$-dimensional case. To motivate the definitions, and the ideas we will use in the following sections, we want to start by presenting a proof for the much more simple two-dimensional case.

\begin{proposition}
	The \EndOfLine-instance that results from reducing the \Sperner-instance generated by a monotone function $f : L \rightarrow L$, has no cycles.
\end{proposition}
\begin{proof}
	The idea of the proof will be to show that any sequence of simplices that are generated by walking through edges colored $0 - 1$, can only cross an axis parallel to the $x$-axis, once.

	Let $L_{d_1= K}$ for $K \in [N]$ be such an axis given by:
	\begin{align*}
		L_{d_1=K} = \set{x \in L : x[1] = K}
	\end{align*}
	Now let us assume that we have a path of simplices that crosses $L_{d_1 = K}$ twice. Then there must be two edges colored $0 - 1$ on $L_{d_1=K}$. Now let us call these two edges $(x_1, x_2)$ and $(y_1, y_2)$, such that $x_1 < x_2$ and $y_1 < y_2$. We want to discuss how these edges can be colored. If $c(x_1) = 0$ and $c(x_2) = 1$, we get a contradiction because this leads to $f(x_1)[1] > f(x_2)[1]$. Hence this cannot occur. A similar argument for $y_1, y_2$ yields that $c(x_1) = c(y_1) =1$ and $c(x_2) = c(y_2) = 0$. For convenience a sketch of the situation is given in \cref{fig:sketch_two_dimensional_proof}.

	Now when walking along edges colored $0 - 1$, we notice that the edge we traverse should always be oriented in the same way. For instance the vertex on our left should be colored $0$ and the vertex on our right colored $1$. Without loss of generality assume that we crossed the edge $x_1 - x_2$ first, then the vertices $y_1 - y_2$ should be colored opposite, to allow us to traverse $L_{d_1=K}$ in the reverse direction. But this is not the case which means that we traverse $L_{d_1=K}$ at most once. This is true for any $K \in [N]$ which garantees that a cycle cannot exist.
\end{proof}
\begin{marginfigure}[-30mm]
	\marginincfig{Sketch_Two_Dimensional_Proof}
	\caption{Sketch of the setting for the two dimensional proof}
	\label{fig:sketch_two_dimensional_proof}
\end{marginfigure}

Let us briefly discuss what the key ingredients for this proof were and what the steps are that we will take to generalize them to the $d$-dimensional case.

On a high level we want to show that one cannot cross a given hyperplane of the lattice more than once when going through rainbow-faces colored $\set{0, \dots, d-1}$. This turns out not to be true but we will be able to show a weaker result, which still prohibits cycles. In two dimensions we did this by showing that when we traverse such a hyperplane we had restrictions on how the edges could be oriented. We will generalize this notion of  \emph{orientation} for the colored faces we are working with. We will then achieve a contradiction by showing that these faces must be oriented the same way if they are part of a path of simplices that form a line in the \EndOfLine\ reduction and obtain a contradiction from this.

In order to this we will first need to define the notion of \emph{orientation} for colored simplices. We will then need to show that the monotonicity of $f$ prohibits certain simplices from existing, and use this to obtain a contradiction.

\section{Orientation of a the simplicial decomposition}[Orientating the simplices]

In this section we discuss how to orient the simplicial decomposition of the lattice, we defined in the previous section. This will be important as we will argue in the next section, that the existence of a cycle would contradict the orientation of the simplicial decomposition. We start by defining what we mean by an orientation of a simplex and then discuss how to extend this to a general simplicial complex.

\subsection{Orientation of a simplex}[Orienting a simplex]
\label{sec:orientation_of_simplex}

\begin{definition}[Orientation of a simplex]
	An \define{orientation} of a simplex $S$ spanned by the vertices $v_0, \dots, v_d$ is a choice of a permutation of the vertices $[v_{\pi(0)}, \dots, v_{\pi(d)}]$.
\end{definition}

Notice that this leaves us with $d!$ possible orientations of a simplex. Our notion of orientability should only lead to two possible classes of orientations, as an orientation of a 1-simplex is simply a choice of direction, and an orientation of a 2-simplex is a choice of a cyclic order of the vertices. Hence we want to define when two orientations are equivalent.

\begin{definition}[Equivalent orientations]
	Two orientations $\pi$ and $\sigma$ of a simplex $S$ are \define{equivalent} if they differ by an even permutation. That is if $\sigma = \pi \circ \tau$ for some permutation $\tau$ with an even number of inversions.
\end{definition}

In particular we give a more explicit definition of the equivalence of orientations of a 2-simplex, by relying on a total order $\preceq$ of the vertices\marginnote{For a lattice this can be achieved by defining $\preceq$ to be the lexicographic order of the vertices.}. We then get the following useful lemma:

\begin{lemma}
	Two orientations $\sigma, \tau$ of a simplex $S$ are equivalent if and only if $\sgn{\sigma} = \sgn{\tau}$, with respect to the total order $\preceq$.
\end{lemma}

We would like to define the \define{opposite orientation} of a simplex, which should be an orientation which has the opposite sign with respect to the total order $\preceq$. This can be achieved by setting:
\begin{align*}
	- [v_0, v_1, v_2, \dots, v_d] = [v_1, v_0, v_2, \dots, v_d]
\end{align*}
We then have that the opposite orientation is not equivalent to the original orientation. This way we have a representative of both equivalence classes.

This means that we now have two equivalence classes of orientations for any simplex. We want to discuss how an orientation of a simplex extends to the faces of this simplex next. Notice that the faces of a simplex are themselves simplices, and thus have an orientation. Let $[v_0, \dots, v_{d}]$ be an orientation of a simplex $S$. Now notice that every face can be obtained by removing one of the vertices $v_j$ of $S$. Hence for every face $F$, the permutation $[v_0, \dots, \hat{v_j}, \dots, v_{d}]$ is an orientation of $F$\marginnote{We use the notation $\hat{v_j}$ to denote that $v_j$ is missing.}. But the orientation $- [v_0, \dots, \hat{v_j}, \dots, v_{d}]$ is also a valid orientation of $F$. For reasons which will become appearent latter we define the induced orientation of a face as follows:

\begin{definition}[Induced orientation of a face]
	Let $\sigma = [v_0, \dots, v_{d}]$ be an orientation of a simplex $S$. The \emph{induced orientation} of a face $F$ of $S$, which is obtained by removing the vertex $v_j$ from the vertex, is the orientation:
	\begin{align*}
		\sigma_j = (-1)^j \cdot [v_0, \dots, \hat{v_j}, \dots, v_{d}]
	\end{align*}
\end{definition}

We claim that the induced orientations of faces, yields a consistent orientation of the simplex, that is that for every $d-2$-simplex $E$ which is a face of two $d-1$-simplices $S_1$ and $S_2$, the induced orientations of $E$ in $S_1$ and $S_2$ are opposite.

\begin{claim}
	\label{claim:opposite_orientations}
	Let $F_1$ and $F_2$ be two $d-1$-simplices in $S$ which share a common face $E$. Then the induced orientations of $E$ in $S_1$ and $S_2$ are opposite.
\end{claim}
\begin{proof}
	Let $[v_0, \dots, v_{d}]$ be an orientation of $S$. The face $E$ is obtained by removing two vertices $v_i, v_j$ from $S$. Without loss of generality assume that $F_1$ is obtained by removing $v_i$ from $S$ and $F_2$ is obtained by removing $v_j$ from $S$. Then the induced orientations $S_1$ and $S_2$ are:
	\begin{align*}
		S_1: \quad & (-1)^i \cdot [v_0, \dots, \hat{v_i}, \dots, v_{d}] \\
		S_2: \quad & (-1)^j \cdot [v_0, \dots, \hat{v_j}, \dots, v_{d}]
	\end{align*}
	Now without loss of generality assume that $i < j$, then we have that the induced orientations of $E$ in $S_1$ and $S_2$ are:
	\begin{align*}
		\text{$E$ in $S_1$ }: \quad & (-1)^i \cdot (-1)^{j-1} \cdot [v_0, \dots, \hat{v_i}, \dots, \hat{v_j}, \dots, v_{d-1}] \\
		\text{$E$ in $S_2$ }: \quad & (-1)^j \cdot (-1)^i \cdot [v_0, \dots, \hat{v_i}, \dots, \hat{v_j}, \dots, v_{d-1}]
	\end{align*}
	This shows that the induced orientations of $E$ in $S_1$ and $S_2$ are opposite.
\end{proof}

\begin{figure}[ht]
	\centering
	\incfig{Orientation_of_Simplex}
	\caption[Orientation of a simplex]{Example of the orientation of a 3-simplex on the left, and the induced orientation of the faces on the right.}
	\label{fig:orientation_of_simplex}
\end{figure}

We give an example of the orientation of a 3-simplex and its faces in \cref{fig:orientation_of_simplex}. We can now discuss how we can extend this notion to a general simplicial complex.

\subsection{Orientation of a simplicial complex}[Orienting a simplicial complex]

A simplicial complex can be thought of as a collection of simplices which are be glued together on their face. Our goal is now to extend this notion of orientation to these simplicial complexes. Formally we define a simplicial complex as follows \sidecite{munkres_elements_2018}:

\begin{definition}[Simplicial complex]
	A \define{simplicial complex} $\mathcal{K}$ in $\R^d$ is a collection of simplices such that:
	\begin{enumerate}
		\item Every face of a simplex in $\mathcal{K}$ is also in $\mathcal{K}$.
		\item The intersection of any two simplices in $\mathcal{K}$ is a face of both simplices.
	\end{enumerate}
\end{definition}

The lattice points which we are interested in, together with Freudenthal's simplicial decomposition of each cell, form a simplicial complex. We now want to define an orientation of a simplicial complex. Of course such an orientation relies on an orientation of each simplex, and we want to make sure that these orientations are in some sence ``compatible'' on the faces of the simplicial complex. We will define this notion in the following definition.

\begin{definition}[Orientation of a simplicial complex]
	An \define{orientation} of a simplicial complex $\mathcal{K}$ is a choice of an orientation of every $d$-simplex in $\mathcal{K}$, such that for every intersection of two simplices $S_1, S_2 \in \mathcal{K}$, the induced orientation of the face $F = S_1 \cap S_2$ in $S_1$ and $S_2$ are opposite. \par
	If such an orientation exists, we say that the simplicial complex is \define{orientable}.
\end{definition}

We now claim that the simplicial complex formed by the lattice points and Freudenthal's simplicial decomposition is orientable. This will be crucial in the next section, where we will argue that the existence of a cycle in the \EndOfLine\ instance would contradict the orientation of the simplicial complex. In particular this shows that a Mobius Strip or the higher dimensional equivalents do not exist in our simplicial complex.

\begin{claim}
	The simplicial complex formed by the lattice points and Freudenthal's simplicial decomposition is orientable.
\end{claim}

\begin{figure}[ht]
	\centering
	\incfig{Orientation_of_Freudenthal_Example}
	\caption[Orientation of a simplicial complex]{Example of the orientation of a Freundenthals simplicial complex in 2 dimensions.}
	\label{fig:orientation_of_simplicial_complex}
\end{figure}

\begin{proof}
	We will give an orientation of every $d$ simplex, and then show that the induced orientation of the faces of the simplicial complex are opposite.
	Let $\pi \in S^d$ be a permutation of the dimensions, and $v_0 \in L$ a vertex of the lattice. We then obtain a simplex $S_{\pi} \in \mathcal{S}$ as previously described:
	\begin{align*}
		v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d)} v_d
	\end{align*}
	We now orient $S_{\pi}$ using the permutation:
	\begin{align*}
		\sigma = \sgn{\pi} \cdot [v_0, \dots, v_d]
	\end{align*}
	First we notice that for all $d-2$ simplices, two neighbooring $d-1$-simplices are contained  in exactly one $d$ simplex of the decomposition, and hence the orientation is consistent, as discussed in claim \ref{claim:opposite_orientations}. \par
	Now let us look at a common face $F$ of two $d$-simplices $S_1$ and $S_2$. We proceed by case distinction:
	\begin{case}{1}
		Assume that $S_1$ and $S_2$ are in the same cell, then $F$ is of the form:
		\begin{align*}
			F: \quad v_0 \xrightarrow{\pi(1)}  \cdots v_{i-1} \xrightarrow{\pi(i), \pi(i+1)} v_{i+1} \xrightarrow{\pi(i+1)} v_{i} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		\end{align*}
		And we have that $S_1$ and $S_2$ are of the form:
		\begin{align*}
			S_1: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i+1)} w_i \xrightarrow{\pi(i)} v_{i} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d  \\
			S_2: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i)} w_i' \xrightarrow{\pi(i+1)} v_{i} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		\end{align*}
		We immediately notice that $\sgn{S_1} = - \sgn{S_2}$\marginnote{By abuse of notation we will denote by $\sgn{S_1}$ the sign of the permutation inducing $S_1$.}. We remove a vertex $w_i, w_i'$ of the same rank in $S_1$ and $S_2$ in order to obtain $F$. Hence the induced orientation of $F$ in $S_1$ and $S_2$ are opposite.
	\end{case}
	\begin{case}{2}
		Next assume that $S_1$ and $S_2$ are in neighbooring cells, then as dicussed in \cref{rem:faces_of_simplex} $F$ is of the form:
		\begin{align*}
			F: \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots  \xrightarrow{\pi(d-1)} v_{d-1}
		\end{align*}
		And we have that $S_1$ and $S_2$ are of the form:
		\begin{align*}
			S_1: & \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \xrightarrow{\pi(d)} w_d \\
			S_2: & \quad w_0 \xrightarrow{\pi(d)} v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \\
		\end{align*}
		We once again must proceed by case distinction.
		\begin{case}{2.1}
			If $d$ is even, then: $\sgn{S_1} = - \sgn{S_2}$, and we remove a vertex of rank $d$ in $S_1$ and of rank $0$ in $S_2$ to obtain $F$. We have $(-1)^d = (-1)^0 = 1$ and hence the induced orientation of $F$ in $S_1$ and $S_2$ are opposite.
		\end{case}
		\begin{case}{2.2}
			If $d$ is odd, then $\sgn{S_1} = \sgn{S_2}$, and we remove a vertex of rank $d$ in $S_1$ and of rank $0$ in $S_2$ to obtain $F$. We have $(-1)^d = -1$ and $(-1)^0 = 1$ and hence the induced orientation of $F$ in $S_1$ and $S_2$ are opposite.
		\end{case}
	\end{case}
	This shows that the simplicial complex formed by the lattice points and Freudenthal's simplicial decomposition is orientable.
\end{proof}

We give an example of such an orientation in \cref{fig:orientation_of_simplicial_complex}. Now that we have shown that the Freudenthal decomposition is orientable, we want to talk about how it can be extended to colored simplices in the next section.

\subsection{Orienting colored simplices}[Colored orientations]

In the previous sections we dicussed how one could orient simplices. We now want to discuss the orientation of colored faces. We are only interested in rainbow-faces, i.e.~$d-1$-dimensional faces, colored with all colors $\set{0, \dots, d-1}$, as these are the faces that we traverse when reducing \Sperner\ to \EndOfLine. We should obtain two orientations for every face, depending on what direction we traverse it in.

\begin{definition}[Orientation of colored faces]
	Let $F$ be a face of a simplex $S$. Let the vertices of $F$ be labelled $v_1, \dots, v_d$, such that $v_1 < \cdots < v_d$. Then there is a permutation $\gamma \in S_d$ such that:
	\begin{align*}
		c(v_{\gamma(1)}) < c(v_{\gamma(2)}) < \cdots < c(v_{\gamma(d)})
	\end{align*}
	Then with $\sigma_F$ the induced orientation of $F$ in $S$, the orientation of the colored face $F$ is:
	\begin{align*}
		\orient_S(F) = \sgn{\gamma} \cdot \sgn{\sigma_F}
	\end{align*}
\end{definition}

Now we should check that our definition is sound. We want that the orientation of a face $F$ is opposite when traversing the face from opposite sides. This is the content of the following lemma.

\begin{lemma}[Well-definedness of colored orientation]
	Let $S_1$ and $S_2$ be two $d$-dimensional simplices which share a $d-1$-dimensional rainbow face $F$. Then:
	\begin{align*}
		\orient_{S_1}(F) = - \orient_{S_2}(F).
	\end{align*}
\end{lemma}
\begin{proof}
	Because the simplicial complex we work with is orientable, for $\indorient_{S_1}(F)$ the induced orientation of $F$ in $S_1$ and $\indorient_{S_2}(F)$ the induced orientation of $F$ in $S_2$, we have:
	\begin{align*}
		\sgn{\indorient_{S_1}(F)} = - \sgn{\indorient_{S_2}(F)}
	\end{align*}
	This immediatetly implies the desired result.
\end{proof}

\section{Sequences of simplices}[Sequences of simplices]

In this section we introduce and study \emph{sequences of simplices}. We will show that they have some nice properties in regard to the orientation of the simplicial decomposition which we previously discussed. This will be useful as we will argue that paths in the \EndOfLine\ instance are sequences of simplices, and that the orientation of the simplicial decomposition will prevent these paths from forming cycles. We start by defining what we mean by a sequence of simplices.

\begin{definition}[Sequence of simplices]
	\label{def:sequence_of_simplices}
	A \emph{sequence of simplices}, or \define{simplicial sequence} is a sequence $\left(S_i\right)_{i=1}^{k}$ of $d$-dimensional simplices $S_i \in \mathcal{S}$ such that:
	\begin{enumerate}
		\item $S_{i+1} \not\subset \set{S_1, \dots, S_i}$ for all $i \in \set{1, \dots, k-1}$.
		\item $S_i$ and $S_{i+1}$ share a $d-1$-dimensional face $F_i$ for all $i \in \set{1, \dots, k-1}$.
	\end{enumerate}
\end{definition}
We want to also introduce formally the notion of \emph{transition faces}, which will represent the face we are \emph{walking through}.

\begin{definition}[Transition faces]
	\label{def:transition_faces}
	Let $\left(S_i\right)_{i=1}^{k}$ be a simplicial sequence. We call the sequence $\left(F_i\right)_{i=1}^{k-1}$, of $d-1$-dimensional faces given by $F_i = S_i \cap S_{i+1}$, the \define{transition sequence}. We call the individual $F_i$ \emph{transition faces}.
\end{definition}

Let us now restrict these general definitions to the context that we will be studying.  We will only be studying sequences where the $F_i$'s are rainbow faces i.e.~faces colored with exactly the colors $\set{0, \dots, d-1}$. We will call a sequence of simplices with this property a \define{rainbow simplicial sequence}. We say that a rainbow simplicial sequence is \define{maximal} if it cannot be extended, i.e. if there is not simplex $S_{i+1}$ such that $\left(S_i\right)_{i=1}^{k+1}$ is a valid rainbow sequence. This can be the case if both $S_1$ and $S_k$ are rainbow simplices (colored exactly with $\set{0, \dots, d}$) or if we have a cycle. Notice that maximal rainbow simplicial sequences are exactly the sequences of simplices which yield the lines in the \EndOfLine\ instance which we reduce \Sperner\ instances to. We now want to make a statement about how these rainbow transition faces are oriented.

\begin{lemma}[Orientation of transition faces]
	Let $\left(S_i\right)_{i=1}^{k}$ be a valid rainbow simplicial sequence. $\left(\orient_{S_i}(F_i)\right)_{i=1}^{k-1}$ is constant.
\end{lemma}

This means that our definition of orientation of colored faces, makes sence: when we walk though these faces, we always walk through faces which are oriented in the same way.

\begin{proof}
	It suffices to show that for all $i \in \set{1, \dots, k-2}$:
	\begin{align*}
		\orient_{S_i}(F_i) =  \orient_{S_{i+1}}(F_{i+1})
	\end{align*}
	Fix $i$, and notice that $F_i$ and $F_{i+1}$ are both faces of $S_{i+1}$. Let us label the vertices of $S_i$ $v_0 < v_1 < \dots < v_d$. Let us denote $k$ and $j$ such that $F_i$ is obtained by removing $v_k$ from $S_{i+1}$ and $F_{i+1}$ is obtained by removing $v_j$ from $S_{i+1}$.

	Without loss of generality assume that $k < j$. TODO write the remainded of this proof.
\end{proof}




\subsection{General properties of the coloring}

\marginnote{Recall that the coloring was given by: \begin{align*}
		c(x) =
		\begin{cases}
			0 & \text{if $x \leq f(x)$}         \\
			1 & \text{else if $x[1] > f(x)[1]$} \\
			  & \vdots                          \\
			d & \text{else if $x[d] > f(x)[d]$}
		\end{cases}
	\end{align*}}
For this section we assume that we are working on a integer lattice $L$, and that for a function $f : L \rightarrow L$, the points have been colored $c : L \rightarrow \set{0, \dots, d}$ as in \cref{sec:tarskistar_to_sperner}. Now we are ready to present a first observation, which will be a helpful stepping stone for more advanced results.

\begin{lemma}
	\label{lem:monotone_coloring}
	Assume that $f$ is monotone and that we have $x_i, x_j \in L$, $c(x_i) = i$ and $c(x_j) = j$ for $i, j \in \set{1, \dots, d}$ and $x_i[i] = x_j[i]$, then either:
	\begin{enumerate}
		\item $i \geq j$ or
		\item $i < j$  and $x_i \not\geq x_j$
	\end{enumerate}
\end{lemma}
\begin{proof}
	Assume that $i < j$ and $x_i \geq x_j$. We must then have $f(x_j)[i] \geq x_j[i] = x_i[i] > f(x_i)[i]$. Now by monoticity of $f$ we must have $f(x_i) \geq f(x_j)$, which is not possible if $f(x_j)[i] > f(x_i)[i]$. Hence we must have $x_i \not\geq x_j$. This shows that the lemma holds.
\end{proof}

For vertices of a given simplex we get the following corollary.
\marginnote[10mm]{Notice that if we assume that $x_i$ and $x_j$ are in the same simplex of the simplicial decomposition, then the condition $x_i \not\geq x_j$ is equivalent to $x_i \leq x_j$.}
\begin{corollary}
	\label{cor:monotone_coloring}
	Assume that $f$ is monotone and that we have $x_i, x_j \in S$, for some simplex $S\in  \mathcal{S}$. Further assume that $c(x_i) = i$ and $c(x_j) = j$ for $i, j \in \set{1, \dots, d}$ with $i < j$ and that $x_i[i] = x_j[i]$, then $x_i < x_j$.
\end{corollary}
\begin{proof}
	$x_i \leq x_j$, follows immediately. Because $x_i$ and $x_j$ are colored differently, they can not be equal which shows the strict inequality.
\end{proof}
\subsection{Properties of sequences of simplices}

Now we want to work with sequences of simplices, and show that the coloring of the vertices of these simplices have some nice properties. We start by defining what we mean by a sequence of simplices. Let $C \subset \{0, \dots, d\}$ be a subset of colors.
\begin{definition}[Valid sequence of simplices]
	\label{def:valid_sequence_simplices}
	\marginnote[-10mm]{Notice that this means that the first and last simplex of the sequence could be colored with any color. All other simplices must be colored with colors in $C$.}
	A \emph{valid sequence of simplices for colors $C$} is a sequence $\left(S_i\right)_{i=1}^{k}$ of simplices as defined previously in \cref{def:sequence_of_simplices} such that the $F_i$ are colored exactly colors of $C$.
\end{definition}
These sequences are the objects that latter get reduced to paths in the \EndOfLine\ instance, which is why we want to study them in detail. We define the some more terminology to help us with this.
\begin{definition}[Cycle]
	\marginnote[-10mm]{Note that the empty sequence, and all sequences consisting of a single simplex are cycles.}
	A \emph{cycle of simplices for colors $C$} is a valid sequence $\left(S_i\right)_{i=1}^{k}$ of simplices $S_i \in \mathcal{S}$ for colors $C$ such that $S_{k+1} = S_1$.
\end{definition}
\begin{definition}[Maximal sequence]
	\marginnote[-10mm]{Inuitively we say that a sequence is maximal if we cannot make it longer by adding simplices at the beginning or end.}
	A \emph{maximal sequence of simplices for colors $C$} is a valid sequence $\left(S_i\right)_{i=1}^{k}$ of simplices $S_i \in \mathcal{S}$ for colors $C$ such that:
	\begin{enumerate}
		\item There is no simplex $S_{k+1} \in \mathcal{S}$ such that $\left(S_i\right)_{i=1}^{k+1}$ is a valid sequence.
		\item There is no simplex $S_{0} \in \mathcal{S}$ such that $\left(S_i\right)_{i=0}^{k}$ is a valid sequence.
	\end{enumerate}
\end{definition}
Finally we want to define the sequence of all transitions between simplices in a sequence.
\begin{definition}[Transition sequence]
	The \emph{transition sequence} of a valid sequence $\left(S_i\right)_{i=1}^{k}$ of simplices $S_i \in \mathcal{S}$ is the sequence $\left(F_i\right)_{i=1}^{k-1}$ of $(d-1)$-dimensional faces $F_i = S_i \cap S_{i+1}$.
\end{definition}

We now are ready to study the properties of these sequence in more detail. We now restrict ourselves to the case where $C \subset \{0, \dots, d\}$ contains exactly $d$ colors (i.e.~only one color is left out). Notice that for a valid sequence $\left( S_i \right)_{i=1}^k$ we then have that the transition sequence $\left( F_i \right)_{i=1}^{k-1}$ is a sequence of $(d-1)$-dimensional simplices $S_i$ which are colored with all $d$ colors of $C$. This means that for every $j \in C$ we get a sequence of vertices $(x_i^j)_{i=1}^k$ such that $x_i^j \in F_i$ and $c(x_i^j) = j$. We will now study this special case in more detail.

\begin{lemma}
	Let $S_i$, $F_i$ and $x_j$ be as above. For any $i \in \set{1, \dots, k-1}$ there is exactly one $j \in C$ such that we have $x_i^j \neq x_{i+1}^j$.
\end{lemma}
\begin{proof}
	$F_i$ and $F_{i+1}$ are two faces of the same $d$ dimensional simplex, and thus they share exactly $d-1$ vertices. This means that there is exactly one vertex $x$ which is in $F_i$ but not in $F_{i+1}$, and exactly one vertex $y$ which is in $F_{i+1}$ but not in $F_i$. This means that there is exactly one $j$ such that $x_i^j = x$ and $x_{i+1}^j = y$.
\end{proof}

Now for a valid sequence $\left(S_i\right)_{i=1}^{k}$ of simplices, inside the color set $C = \{0, \dots, d-1\}$ we can consider all the vertices that are not colored with the color $0$. These vertices have a nice structure as the following proposition shows.

\begin{proposition}
	Let $\left(S_i\right)_{i=1}^{k}$ be a valid sequence of simplices for colors $C = \{0, \dots, d-1\}$, then defining $L_i$ to be the face of $S_i$ which is spanned by the vertices colored with colors in $C \setminus \set{0}$. Then the sequence $\left(L_i\right)_{i=1}^{k}$ is a sequence of faces as defined in \cref{def:sequence_of_faces}.
\end{proposition}
\begin{proof}
	We need to show that the two conditions set by \cref{def:sequence_of_faces} are satisfied. The first condition is immediate as $L_i$ is a face of $S_i$. For the second condition we need to show that $L_i$ and $L_{i+1}$ share a $d-2$-dimensional face for every $i \in \set{1, \dots, k-1}$. In order to see this notice that $S_i$ and $S_{i+1}$, share a common face $F_i$, which contains exactly one vertex colored with color $0$. This means that $L_i$ and $L_{i+1}$ share a $d-2$-dimensional face of $F_i$, and hence a $d-2$ dimensional face of $S_i$ and $S_{i+1}$.
\end{proof}

As a direct consequence of this proposition we get the following corollary, which will be a key tool in the discussion on cycles in the \EndOfLine\ instance.

\begin{corollary}
	The $\left(L_i\right)_{i=1}^{k}$ defined above can be oriented consistently.
\end{corollary}
\begin{proof}
	This is a direct consequence of \cref{prop:orientation_of_sequences_of_faces}, which showed that the orientation of the faces of a sequence of simplices is consistent, when using the induced orientation of the faces by the individual simplices.
\end{proof}

\section{No cycles in the \EndOfLine\ instance}[No cycles in the \EndOfLine\ instance]

Now we are ready to show that the \EndOfLine\ instance does not contain any cycles. We do this by showing that the existence of a cycle would contradict the orientation of the simplicial complex. A cycle is a valid sequence such that $S_0$ and $S_k$ are a $(d-1)$-simplex as a face. We will show that certain situations cannot occur due to the orientation of the simplicial complex before argueing that these situations must occur in a cycle. This will be enough to show that the \EndOfLine\ instance does not contain any cycles.

Before we start we want to make an observation on how the dimension $d$ plays together with the orientation of the simplicial complex.
\begin{lemma}
	\label{lem:position_of_d_in_simplex}
	Let $l \in \set{1, \dots, d-1}$ be a dimension. Let $S$ be a $d$-simplex with colors $C = \set{0, \dots, d-1}$ in the colored simplicial complex, such that $S$ is of the form:
	\begin{align*}
		(S): \quad v_0 \xrightarrow{l} v_1 \xrightarrow{} \cdots \xrightarrow{} v_d
	\end{align*}
	and assume that the face $F$ spanned by $v_1, \dots, v_d$ is a rainbow face. Then we must have for the colors:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{}  \cdots \xrightarrow{d} \cdots  0 \xrightarrow{} \cdots \xrightarrow{} c(v_d)
	\end{align*}
\end{lemma}
\begin{proof}
	Every color $c \in \set{0, \dots, d-1}$ appears exactly once in the face $F$. If the color $c \neq 0$ appear after $0$, then by \cref{cor:monotone_coloring} we must have that we move in dimension $c$ between $0$ and $c$:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{} \cdots  0 \xrightarrow{} \cdots \xrightarrow{c} \cdots \xrightarrow{} c
	\end{align*}
	Because we have this for every color $c_i \neq 0$, which appears after $0$ in $F$ we must have:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{} \cdots  0 \xrightarrow{c_1} c_1 \xrightarrow{c_2} c_2 \cdots \xrightarrow{c_k} c_k
	\end{align*}
	Now it is clear that because no vertex is colored with $d$, we must have that the change in dimension $d$ occurs before the vertex colored $0$ appears. This shows that we must have:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{}  \cdots \xrightarrow{d} \cdots  0 \xrightarrow{} \cdots \xrightarrow{} c(v_d)
	\end{align*}
	This shows the Lemma.
\end{proof}
Next we show that a sequence of colored simplices as defined previously, can only cross a given hyperplane, given by fixing a dimension $l$, at most once. This will be a key tool in the discussion on cycles in the \EndOfLine\ instance. Formally we have the following proposition.
\begin{proposition}
	Let $l \in \set{1, \dots, d-1}$ be a dimension. Consider the hyperplane $H$ given by fixing $l = L$ for some $L \in [N]$\marginnote[0mm]{In other words $H$ is given by ${H = \set{x \in \R^d \mid x[l] = L}}$}. Then consider the sequence of simplices $\left(S_i\right)_{i=1}^{k}$ such as defined previously. Then there can not be two $i \neq j$ such that $F_i \subset H$ and $F_j \subset H$.
\end{proposition}
Prior to proving this result, it is essential to highlight the underlying rationale behind its significance. This implies that, with the exception of the dimension $d$ the sequences of simplices that induce the paths in the \EndOfLine\ instance are monotone. Now let us prove this result.
\begin{proof}
	For the sake of contradiction assume that there are two such $i \neq j$, such that $F_i \subset H$ and $F_j \subset H$. Without loss of generality we can further assume that $i < j$ and that for all $k \in \set{i+1, \dots, j-1}$ we have $F_k \not\subset H$, if so then replace $j$ with the smallest such $k$.\par
	Now notice that $S_i$ and $S_{j}$ are on opposite sides of $H$, and that $S_{i+1}$ and $S_{j}$ are on the same side of $H$. Now let us consider the sequence of colored simplices $S_{i+1}, \dots, S_j$. Notice that \cref{lem:position_of_d_in_simplex}, which we proved earlier, implies that both $F_i$, and $F_j$ must be of the following form:
	\begin{align*}
		(F_i) & : \quad c(v_1) \xrightarrow{}  \cdots \xrightarrow{d} \cdots  0 \xrightarrow{} \cdots \xrightarrow{} c(v_d) \\
		(F_j) & : \quad c(w_1) \xrightarrow{}  \cdots \xrightarrow{d} \cdots  0 \xrightarrow{} \cdots \xrightarrow{} c(w_d)
	\end{align*}
	We will now proceed by case distinction:
	\begin{case}{1}
		Assume that $F_i$ and $F_j$ are comparable\marginnote[0mm]{By \emph{comparable} we mean that the cell containing $F_i$ is either larger or smaller than the cell containing $F_j$.}. We want to show that this is not possible. Assume without loss of generality that $F_i$ is smaller than $F_j$. Then the vertex colored $0$ in $F_i$ must be smaller than the vertex colored $l$ in $F_j$. This leads to a violation of monotonicity according to \cref{cor:monotone_coloring}.
	\end{case}
	\begin{case}{2}
		Assume that $F_i$ and $F_j$ are not comparable. Our goal is to show that in this case we do not have a consistent orientation of the faces $L_i$ and $L_{j-1}$.
	\end{case}
\end{proof}