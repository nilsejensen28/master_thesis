\setchapterpreamble[u]{\margintoc}
\chapter{Reducing \Tarski\ to \EOPL}
\label{ch:eopl_reduction}

In the previous chapter, we demonstrated how one can prove the membership of \Tarski\ in \PPAD\ through a reduction to \Sperner\ and then a reduction from \Sperner\ to \EndOfLine. We want to argue that the \EndOfLine\ instance we obtain when reducing a monotone function $f$ is almost an \EndOfPotentialLine\ instance. In particular, recall from \cref{ch:preliminaries} that the main difference is the absence of cycles in \EndOfPotentialLine\ instances, while such cycles might exist in \EndOfLine\ instances. The absence of cycles in the \EndOfPotentialLine\ instances is guaranteed by a potential. In this chapter, we will argue that the \EndOfLine\ instances that we obtain when reducing monotone functions have no cycles.

In order to argue this result, we will need a more meticulous examination of the structure of a \Tarski\ instance and the induced coloring of the lattice points. We will start by arguing that there are no cycles in the two-dimensional case. Doing this will motivate the following steps to generalize the results to higher dimensions.

First, we will construct a specific simplicial decomposition of the lattice. We do this to obtain specific valuable properties. Then, we will discuss how we orient simplices, their faces, and ultimately, the colored faces we traverse when reducing \Sperner\ to \EndOfLine. Finally, we will discuss how these elements interplay to guarantee the absence of cycles in three dimensions and how this can be generalized.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% No Cycles in 2D Tarski
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Warmup: No cycles in two-dimensional \Tarskistar-instances}[No cycles in two dimensions]

This chapter aims to prove that there are no cycles in the \EndOfLine\ instances that result from the reduction of monotone \Tarskistar-instances onto \EndOfLine we presented in \cref{sec:sperner_eol_reduction}. We will do this by studying the \Sperner\ instances and showing that the sequence of simplices that form the lines of the \EndOfLine-instances cannot form a cycle if the underlying function $f$ is monotone.

Proving this will be somewhat involved in the general $d$-dimensional case. We want to present proof for the more straightforward two-dimensional case to motivate the definitions and ideas we will use in the following sections.

\begin{proposition}
	The \EndOfLine-instance that results from reducing the two-dimensional \Sperner-instance generated by a two-dimensional monotone function $f : L \rightarrow L$ has no cycles.
\end{proposition}
\begin{proof}
	The proof's idea is to show that any sequence of simplices generated by walking through edges colored $0 - 1$ can only cross an axis parallel to the $x$-axis once.

	Let $L_{d_1= K}$ for $K \in [N]$ be such an axis given by:
	\begin{align*}
		L_{d_1=K} = \set{x \in L : x[1] = K}
	\end{align*}
	Let us assume that we have a path of simplices that crosses $L_{d_1 = K}$ twice. Then there must be two edges colored $0 - 1$ on $L_{d_1=K}$. Now let us call these two edges $(x_1, x_2)$ and $(y_1, y_2)$, such that $x_1 < x_2$ and $y_1 < y_2$. We want to discuss how these edges can be colored. If $c(x_1) = 0$ and $c(x_2) = 1$, we get a contradiction because this leads to $f(x_1)[1] > f(x_2)[1]$. Hence, this cannot occur. A similar argument for $y_1, y_2$ yields that $c(x_1) = c(y_1) =1$ and $c(x_2) = c(y_2) = 0$. For convenience, a sketch of the situation is given in \cref{fig:sketch_two_dimensional_proof}.

	Now, when walking along edges colored $0 - 1$, we notice that the edge we traverse should always be oriented in the same way. For instance, the vertex on our left should be colored $0$, and the vertex on our right should be colored $1$. Without loss of generality, assume that we crossed the edge $x_1 - x_2$ first, then the vertices $y_1 - y_2$ should be colored opposite to allow us to traverse $L_{d_1=K}$ in the reverse direction. However,  this is not the case, meaning we traverse $L_{d_1=K}$ at most once. This is true for any $K \in [N]$, which guarantees that a cycle cannot exist.
\end{proof}
\begin{marginfigure}[-30mm]
	\marginincfig{Sketch_Two_Dimensional_Proof}
	\caption{Sketch of the setting for the two-dimensional proof}
	\label{fig:sketch_two_dimensional_proof}
\end{marginfigure}

Let us briefly discuss this proof's key ingredients and the steps we will take to generalize them to the $d$-dimensional case.

On a high level, we want to show that one cannot cross a given hyperplane of the lattice more than once when going through rainbow faces colored $\set{0, \dots, d-1}$. This turns out not to be accurate, but we will show a weaker result, which still prohibits cycles. In two dimensions, we did this by showing that when we traverse such a hyperplane, we had restrictions on how the edges could be oriented. We will generalize this notion of \emph{orientation} for the colored faces we work with.  We will then achieve a contradiction by showing that these faces must be oriented the same way if they are part of a path of simplices that form a line in the \EndOfLine\ reduction and obtain a contradiction from this.

In order to do this, we will need to discuss in detail how we subdivide the cells of the lattice into simplices; we will do this by introducing \emph{Freudenthal's simplicial decomposition}. Once we have the simplices, we will discuss \emph{sequences of simplices}, which are the objects that will turn into the lines of the \EndOfLine\ instances. Then, we define the notion of \emph{orientation} for colored simplices. We will then need to show that the monotonicity of $f$ prohibits certain simplices from existing and use this to obtain a contradiction to the existence of cycles.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Freudenthals Simplicial decomposition
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Choosing a simplicial decomposition of the lattice --- Freudenthal's Simplical Decomposition}[Freudenthal's Simplical Decomposition]
\label{sec:freudenthal_simplicial_decomposition}

In the previous chapter, we left the choice of a specific simplicial decomposition of the lattice open, as it did not contribute to our reduction. In this chapter, we aim to be more precise in our approach by selecting a specific simplicial decomposition that will enable us to derive structural results. We begin by outlining the desired properties of our simplicial decomposition. The most fundamental property is that every simplex of the decomposition must be contained within a single cell of the lattice. This implies we can limit our inquiry to identifying a simplicial decomposition of a single $d$-dimensional hypercube of side-length $1$.

Additionally, it is essential to note that our objective does not entail the introduction of any new vertices; instead, we seek a decomposition of the hypercube that can be expressed as a set of subsets of the hypercube's vertices. Finally, we which for the vertices of a given simplex be totally ordered with respect to the partial order defined in \cref{sec:tarski_problem}. This will allow us to argue that two vertices inside a given simplex are always comparable, and thus, their images through $f$ must also be comparable, which will be useful.

Such a decomposition exists, and is known in the literature as \textit{Freudenthal's simplical decomposition} \sidecite{freudenthal_simplizialzerlegungen_1942}. We will introduce it combinatorially here and refer the reader to the original paper for a geometric construction of the same decomposition.

\begin{definition}[Freudenthal's Simplicial Decomposition]
	\label[definition]{def:freudenthal_simplicial_decomposition}
	Consider a unit hypercube $[0, 1]^d$ in $\R^d$ and consider $S_d$ the group of all permutations of the dimensions of the hypercube $\{1, \dots, d\}$. For every permutation $\pi \in S_d$, define the simplex $S_{\pi}$ as the convex hull of the vertices:
	\marginnote[10mm]{Here we will use the notation $e_i$ to denote the $i$-th \define{unit vector} in $\R^d$.}
	\begin{align*}
		v_0 & = (0, 0, \dots, 0)                        \\
		v_1 & = v_0 + e_{\pi(1)}                        \\
		v_2 & = v_1 + e_{\pi(2)}                        \\
		    & \vdots                                    \\
		v_d & = v_{d-1} + e_{\pi(d)} = (1, 1, \dots, 1)
	\end{align*}
	The set of such simplexes $\mathcal{S} = \set{S_{\pi} : \pi \in S_d}$ is Freudenthal's simplicial decomposition of the hypercube $[0, 1]^d$.
\end{definition}
We want to argue why this decomposition is well-defined. We begin by showing that every point of the hypercube is contained in at least one simplex of $\mathcal{S}$.
\begin{lemma}
	\label{lem:caracterisation_of_simplices}
	Let $x = (x[1], \dots, x[d]) \in [0, 1]^d$, let $\pi \in S^d$ be the permutation such that $x[\pi(1)] \leq x[\pi(2)] \leq \dots \leq x[\pi(d)]$. Then $x \in S_{\pi}$.
\end{lemma}
\begin{proof}
	We want to show that $x$ is a convex combination of the vertices of $S_{\pi}$. We define the following sequence of real numbers:
	\begin{align*}
		\lambda_0     & = x[\pi(1)]               \\
		\lambda_1     & = x[\pi(2)] - x[\pi(1)]   \\
		\lambda_2     & = x[\pi(3)] - x[\pi(2)]   \\
		              & \vdots                    \\
		\lambda_{d-1} & = x[\pi(d)] - x[\pi(d-1)] \\
		\lambda_d     & = 1 - x[\pi(d)]
	\end{align*}
	Notice that we have $\lambda_i \geq 0$ for all $i$ and $\sum_{i=0}^{d} \lambda_i = 1$, by telescoping the sum. We can now write $x$ as a convex combination of the vertices of $S_{\pi}$ as follows by noticing that $v_i = \sum_{j=0}^{i} e_{\pi(j)}$:
	\begin{align*}
		\sum_{i=0}^{d} \lambda_i v_i & = \sum_{i=0}^{d} \lambda_i \left( \sum_{j=0}^{i} e_{\pi(j)} \right)  = \sum_{i=0}^{d} \sum_{j=1}^{i} \lambda_i e_{\pi(j)}                                             \\
		                             & = \sum_{j=1}^{d} \sum_{i=0}^{j} \lambda_i e_{\pi(j)}  = \sum_{j=1}^{d} e_{\pi(j)} \sum_{i=0}^{j} \lambda_i        = \sum_{j=1}^{d} e_{\pi(j)} x[\pi(j)]           = x
	\end{align*}
	This shows that $x$ is a convex combination of the vertices of $S_{\pi}$, thus $x \in S_{\pi}$.
\end{proof}
Next, we discuss why this forms a partition of the hypercube. Of course, a given point $x$ can be contained in multiple simplexes, but we want to show that this does not happen apart from on the boundary of the simplices.
\begin{lemma}
	Let $S_{\pi} \in \mathcal{S}$ be a simplex. Then the \define{interior} of $S_{\pi}$ is:
	\begin{align*}
		\interior{S_{\pi}} = \set{x \in [0, 1]^d : 0 < x[\pi(1)] < x[\pi(2)] < \dots < x[\pi(d)] < 1}
	\end{align*}
\end{lemma}
\begin{proof}
	The same proof as for lemma \ref{lem:caracterisation_of_simplices} holds with the added constraint that all $\lambda_i > 0$, showing that these points are in the interior of the simplex.
\end{proof}
Together, these two Lemmata show that \textit{Freudenthal's simplicial decomposition} is a well-defined simplicial decomposition of the hypercube. We can now use this decomposition to prove structural results about the lattice points of a \Tarski\ instance. We start by showing that this simplicial decomposition has the desired properties.
\begin{lemma}
    \label{lem:total_order_freudenthal}
	Let $S_{\pi} \in \mathcal{S}$ be a simplex. Then, the vertices of $S_{\pi}$ are totally ordered with respect to the partial order defined in \cref{sec:tarski_problem}. In particular, we claim that:
	\begin{align*}
		v_0 < v_1 < v_2 < \dots < v_d
	\end{align*}
\end{lemma}
\begin{proof}
	Because this relation is transitive it suffice to show that $v_i < v_{i+1}$ for all $i \in \set{0, \dots, d-1}$. This follows immediately from the construction of the $v_i$ as we have $v_i[j] = v_{i+1}[j]$ for all $j \neq \pi(i+1)$ and $v_i[\pi(i+1)] = v_{i+1}[\pi(i+1)] - 1$.
\end{proof}
This lemma directly implies the following corollary.
\begin{corollary}
	\label{cor:total_ordering}
	For two vertices $x,y$ of any simplex $S \in \mathcal{S}$, if for any $i \in \set{1, \dots, d}$ we have $x[i] < y[i]$, then $x < y$. In particular, $x \not\leq y$ is equivalent to $x > y$.
\end{corollary}
Notice that this is not the case for any two points in the hypercube, as the partial order is not a total order. This is why choosing a simplicial decomposition with this property will be crucial in the following sections. Next, we want to introduce a new notation that will allow us to describe these simplices more succinctly. Assume that a permutation $\pi$ of the dimensions, induces a simplex $S_{\pi}$, with vertices $v_0, \dots, v_d$, as defined in \cref{def:freudenthal_simplicial_decomposition}. Then we will denote the $d$-dimensional simplex $S_{\pi}$ as:
\begin{align*}
	v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d)} v_d
\end{align*}
This notation means we obtain $v_i$ by moving by one unit length in the direction $\pi(i)$ from $v_{i-1}$. We already briefly discussed how the faces of a given simplex are given. We will also describe how to describe these faces in our notation. We will denote the face of $S_{\pi}$ obtained by removing the vertex $v_i$ as:
\begin{align*}
	v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(i - 1)} v_{i-1} \xrightarrow{\pi(i), \pi(i+1)} v_{i+1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
\end{align*}

We can remark the following about the faces of a simplex.
\begin{remark}
	\label[remark]{rem:faces_of_simplex}
	For a given $d-1$ dimensional simplex $F$ in $\mathcal{S}$ we have that:
	\marginnote[0mm]{Notice that the case \ref{rem:face_inside_cell} is the case where the face is inside the cell, and the case \ref{rem:face_border_cell} is the case where the face is on the border of the cell.}
	\begin{enumerate}
		\item If $F$ is of the form:
		      \begin{align*}
			      F: \quad v_0 \xrightarrow{\pi(1)}  \cdots v_{i-1} \xrightarrow{\pi(i), \pi(i+1)} v_{i+1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		      \end{align*}
		      Then $F$ is a face of exactly two simplices $S_1$ and $S_2$:
		      \begin{align*}
			      S_1: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i+1)} w \xrightarrow{\pi(i)} v_{i + 1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d  \\
			      S_2: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i)} w' \xrightarrow{\pi(i+1)} v_{i + 1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		      \end{align*}
		      \label{rem:face_inside_cell}
		\item If $F$ is of the form:
		      \begin{align*}
			      F: \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1}
		      \end{align*}
		      Then $F$ is a face of exactly two simplices $S_1$ and $S_2$:
		      \begin{align*}
			      S_1: & \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \xrightarrow{\pi(d)} w \\
			      S_2: & \quad w' \xrightarrow{\pi(d)} v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \\
		      \end{align*}
		      \label{rem:face_border_cell}
	\end{enumerate}
\end{remark}

We discuss what simplices of the decomposition neighbour each other. We claim that a given simplex has $d-1$ neighboring simplices inside a given cell and two neighboring simplices in neighboring cells. More precisely, we have the following lemma.

\begin{lemma}[Neighbooring Simplices]
	Let $S_{\pi} \in \mathcal{S}$ be a simplex:
	\begin{align*}
		v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d)} v_d
	\end{align*}
	Then the following simplices are neighbors of $S_{\pi}$:
	\begin{itemize}
		\item for all $i \in \set{1, \dots, d-1}$, with $w_i$ is the vertex obtained by moving one unit in the direction $\pi(i+1)$ from $v_{i-1}$ the simplex:
        \begin{align*}
            v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots v_{i-1} \xrightarrow{\pi(i+1)} w_i \xrightarrow{\pi(i)} v_{i} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
        \end{align*}
		\item for $w_d$ is the vertex obtained by moving one unit in the direction $-\pi(d)$ from $v_{0}$, the simplex:
        \begin{align*}
            w_d \xrightarrow{\pi(d)} v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d-1)} v_{d-1}
        \end{align*}
		\item for $w_1$ is the vertex obtained by moving one unit in the direction $\pi(1)$ from $v_{d}$, the simplex:
        \begin{align*}
            v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \xrightarrow{\pi(d)} v_d \xrightarrow{\pi(1)} w_1
        \end{align*}
	\end{itemize}
\end{lemma}
\begin{proof}
	The proof follows directly by enumerating the faces of $S_{\pi}$ and using remark \ref{rem:faces_of_simplex}.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Sequences of Simplices
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Sequences of simplices}[Sequences of simplices]

This section introduces and studies \emph{sequences of simplices}.  They will be helpful as we argue that paths in the \EndOfLine\ instance are sequences of simplices, and the colored orientation of the simplicial decomposition will prevent these paths from forming cycles. We start by defining what we mean by a sequence of simplices.

\begin{definition}[Sequence of simplices]
	\label{def:sequence_of_simplices}
	A \emph{sequence of simplices}, or \define{simplicial sequence} is a sequence $\left(S_i\right)_{i=1}^{k}$ of $d$-dimensional simplices $S_i \in \mathcal{S}$ such that:
	\begin{enumerate}
		\item $S_{i+1} \not\subset \set{S_1, \dots, S_i}$ for all $i \in \set{1, \dots, k-1}$.
		\item $S_i$ and $S_{i+1}$ share a $d-1$-dimensional face $F_i$ for all $i \in \set{1, \dots, k-1}$.
	\end{enumerate}
\end{definition}

We also want to introduce formally the notion of \emph{transition faces}, which will represent the face we are \emph{walking through}.

\begin{definition}[Transition faces]
	\label{def:transition_faces}
	Let $\left(S_i\right)_{i=1}^{k}$ be a simplicial sequence. We call the sequence $\left(F_i\right)_{i=1}^{k-1}$, of $d-1$-dimensional faces given by $F_i = S_i \cap S_{i+1}$, the \define{transition sequence}. We call the individual $F_i$ \emph{transition faces}.
\end{definition}

Of course, we need to discuss how to add colors. In the following $C \subset \set{0, \dots, d}$, will be a subset of colors. We will use this subset of colors to define restrictions on how sequences of simplices we study should be colored.

\begin{definition}[Rainbow face]
	Let $C \subset \set{0, \dots, d}$ be a subset of colors, and $F$ a face of a simplicial complex $\mathcal{S}$. We say that $F$ is a \emph{rainbow face} for colors $C$ if all vertices of $F$ are colored with colors from $C$ and all colors in $C$ appear in $F$.
\end{definition}

Now, let us restrict these general definitions to the context we will be studying. We will fix $C = \set{0, \dots, d-1}$.  We will only study sequences where the $F_i$'s are rainbow faces, i.e.~faces colored with exactly the colors $C = \set{0, \dots, d-1}$. We will call a sequence of simplices with this property a \define{rainbow simplicial sequence}. We will only study valid sequences of simplices with this property, as these are the sequences of simplices that become lines in the \EndOfLine\ instances. One property is still missing: the sequences of simplices that reduce to the lines in the \EndOfLine\ instances are \emph{maximal} because they can not be prolonged, motivating the following definition:

\begin{definition}[Maximal sequence]
	\boxmarginnote{Inuitively, we say that a sequence is maximal if we cannot make it longer by adding simplices at the beginning or end.}
	A \emph{maximal sequence of simplices for colors $C$} is a valid sequence $\left(S_i\right)_{i=1}^{k}$ of simplices $S_i \in \mathcal{S}$ for colors $C$ such that:
	\begin{enumerate}
		\item There is no simplex $S_{k+1} \in \mathcal{S}$ such that $\left(S_i\right)_{i=1}^{k+1}$ is a valid sequence.
		\item There is no simplex $S_{0} \in \mathcal{S}$ such that $\left(S_i\right)_{i=0}^{k}$ is a valid sequence.
	\end{enumerate}
\end{definition}

Notice that maximal rainbow simplicial sequences are precisely the sequences of simplices that yield the lines in the \EndOfLine\ instance, which we reduce \Sperner\ instances to. We will discuss how we can orient these sequences simplices in the next section. Before we do this though, we introduce a special type of maximal rainbow simplicial sequence which can arise. Recall that a particular type of line that we can obtain in the \EndOfLine\ instances are cycles. These cycles result from reducing a particular class of simplicial sequences, which we will also call \emph{cycles}.

\begin{definition}[Cycle]
	A \emph{cycle of simplices for colors $C$} is a valid maximal sequence $\left(S_i\right)_{i=1}^{k}$ of simplices $S_i \in \mathcal{S}$ for colors $C$ such that $S_1 \cap S_k$ is a $d-1$ dimensional rainbow face for colors $C$.
\end{definition}

As previously discussed intuitively the main difference between an \EndOfLine instance and a \EndOfPotentialLine instance is the possibility for cycles to exist in the \EndOfLine instance. Hence, our goal is to show that when given a monotone \Tarskistar instance, which we reduce to \Sperner the resulting lattice of colored points does not have any cycles, as defined above

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%A side note on super-unique Tarski
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{A side note on super-unique \Tarski\ instances}[Super-unique \Tarski\ instances]

TODO.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Orientation of Simplices
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Orientation of the simplicial decomposition}[Orientating the simplices]

In this section, we discuss how to orient the simplicial decomposition of the lattice, which we defined in the previous section. This will be important as we will argue in the next section that the existence of a cycle would contradict the orientation of the simplicial decomposition. We start by defining what we mean by an orientation of a simplex and then discuss how to extend this to a general simplicial complex.

\subsection{Orientation of a simplex}[Orienting a simplex]
\label{sec:orientation_of_simplex}

\begin{definition}[Orientation of a simplex]
	An \define{orientation} of a simplex $S$ spanned by the vertices $v_0, \dots, v_d$ is a choice of a permutation of the vertices $[v_{\pi(0)}, \dots, v_{\pi(d)}]$.
\end{definition}

Notice that this leaves us with $d!$ possible orientations of a simplex. Our notion of orientability should only lead to two possible classes of orientations, as an orientation of a 1-simplex is simply a choice of direction, and an orientation of a 2-simplex is a choice of a cyclic order of the vertices. Hence, we want to define when two orientations are equivalent.

\begin{definition}[Equivalent orientations]
    \boxmarginnote{Recall that a permutation $\tau$ has an even number of inversions if and only if $\sgn{\tau}=1$}
	Two orientations $\gamma$ and $\sigma$ of a simplex $S$ are \define{equivalent} if they differ by an even permutation. That is, if $\sigma = \gamma \circ \tau$ for some permutation $\tau$ with an even number of inversions.
\end{definition}

In particular, we give a more explicit definition of the equivalence of orientations of a 2-simplex by relying on a total order $\preceq$ of the vertices of the simplex. We need a total order for the \emph{sign} of a permutation to be well-defined. Because we are working in \emph{Freudenthal's simplicial decomposition} all vertices of a given simplex are totally ordered by \cref{lem:total_order_freudenthal}, hence we can assume that the sign of a permutation is well-defined.

\begin{lemma}
	Two orientations $\sigma, \tau$ of a simplex $S$ are equivalent if and only if $\sgn{\sigma} = \sgn{\tau}$, with respect to a total order $\preceq$.
\end{lemma}
\begin{proof}
    We have that $\sigma, \tau$ are equivalent if and only if they differ by an even permutation $\gamma$. This is equivalent to:
    \begin{align*}
        \sigma = \gamma \circ \tau \quad \text{with $\sgn{\gamma}=1$}
    \end{align*}
    We now prove both directions separately:

    If $\sigma = \gamma \circ \tau$ then we have:
    \begin{align*}
        \sgn{\sigma}= \sgn{\gamma} \cdot \sgn{\tau} = \sgn{\tau}
    \end{align*}
    Because $\sgn{\gamma}=1$.

    In the other direction it is well known that if $\sgn{\sigma}= \sgn{\gamma}$, then they differ by an even permutation.
\end{proof}

We want to define the \define{opposite orientation} of a simplex, which should be an orientation that has the opposite sign with respect to the total order $\preceq$. This can be achieved by setting:
\begin{align*}
	- [v_0, v_1, v_2, \dots, v_d] = [v_1, v_0, v_2, \dots, v_d]
\end{align*}
The opposite orientation is then not equivalent to the original orientation. This way, we have a representative of both equivalence classes.

We now have two equivalence classes of orientations for any simplex. We want to discuss how the orientation of a simplex extends to the faces of this simplex next. Notice that the faces of a simplex are themselves simplices and thus have an orientation. Let $[v_0, \dots, v_{d}]$ be an orientation of a simplex $S$. Now, notice that every face can be obtained by removing one of the vertices $v_j$ of $S$. Hence for every face $F$, the permutation $[v_0, \dots, \hat{v_j}, \dots, v_{d}]$ is an orientation of $F$\marginnote{We use the notation $\hat{v_j}$ to denote that $v_j$ is missing.}. But the orientation $- [v_0, \dots, \hat{v_j}, \dots, v_{d}]$ is also a valid orientation of $F$. For reasons that will become apparent later, we define the induced orientation of a face as follows:

\begin{definition}[Induced orientation of a face]
	Let $\sigma = [v_0, \dots, v_{d}]$ be an orientation of a simplex $S$. The \emph{induced orientation} of a face $F$ of $S$, which is obtained by removing the vertex $v_j$ from the simplex, is the orientation:
	\begin{align*}
		\sigma_j = (-1)^j \cdot [v_0, \dots, \hat{v_j}, \dots, v_{d}]
	\end{align*}
\end{definition}

\begin{figure}[ht]
	\centering
	\incfig{Orientation_of_Simplex}
	\caption[Orientation of a simplex]{Example of the orientation of a 3-simplex on the left and the induced orientation of the faces on the right.}
	\label{fig:orientation_of_simplex}
\end{figure}

We give an example of the orientation of a 3-simplex and its faces in \cref{fig:orientation_of_simplex}. We will show later that this the notion of induced orientation has nice properties when we work with multiple simplices. In order to do so we need to introduce the notion of simplicial complex, and discuss how we orient it, which we will do in the following subsection.

\subsection{Orientation of a simplicial complex}[Orienting a simplicial complex]

A simplicial complex can be considered a collection of simplices glued together on their face. Our goal is to extend this orientation notion to these simplicial complexes. Formally, we define a simplicial complex as in \sidecite{munkres_elements_2018}:

\begin{definition}[Simplicial complex]
	A \define{simplicial complex} $\mathcal{K}$ in $\R^d$ is a collection of simplices such that:
	\begin{enumerate}
		\item Every face of a simplex in $\mathcal{K}$ is also in $\mathcal{K}$.
		\item The intersection of any two simplices in $\mathcal{K}$ is a face of both simplices.
	\end{enumerate}
\end{definition}

The lattice points we are interested in and Freudenthal's simplicial decomposition of each cell form a simplicial complex. We now want to define an orientation of a simplicial complex. Of course, such an orientation relies on an orientation of each simplex, and we want to make sure that these orientations are in some sense ``compatible'' at the faces of the simplicial complex. We will define this notion in the following definition.

\begin{definition}[Orientation of a simplicial complex]
	An \define{orientation} of a simplicial complex $\mathcal{K}$ is a choice of an orientation of every $d$-simplex in $\mathcal{K}$, such that for every intersection of two simplices $S_1, S_2 \in \mathcal{K}$, the induced orientation of the face $F = S_1 \cap S_2$ in $S_1$ and $S_2$ are opposite. \par
	If such an orientation exists, we say that the simplicial complex is \define{orientable}.
\end{definition}

We now claim that the simplicial complex formed by the lattice points and Freudenthal's simplicial decomposition is orientable. This will be crucial in the next section, where we will argue that the existence of a cycle in the \EndOfLine\ instance would contradict the orientation of the simplicial complex. In particular, this shows that a MÃ¶bius strip or the higher dimensional equivalents do not exist in our simplicial complex.

\begin{proposition}[Freudenthal is orientable]
    \label{prop:orientability_freudenthal}
    The simplicial complex formed by the lattice points and Freudenthal's simplicial decomposition is orientable.
\end{proposition}

\begin{figure}[ht]
	\centering
	\incfig{Orientation_of_Freudenthal_Example}
	\caption[Orientation of a simplicial complex]{Example of the orientation of a Freundenthals simplicial complex in 2 dimensions.}
	\label{fig:orientation_of_simplicial_complex}
\end{figure}

We will divide the proof into two separate part. First we want to describe the orientation we give to every simplex in the complex.

We give an orientation of every $d$ simplex and then show that the induced orientation of the faces of the simplicial complex are opposite.
Let $\pi \in S^d$ be a permutation of the dimensions, and $v_0 \in L$ a vertex of the lattice. We then obtain a simplex $S_{\pi} \in \mathcal{S}$ as previously described:
\begin{align*}
    v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} v_2 \xrightarrow{\pi(3)} \cdots \xrightarrow{\pi(d)} v_d
\end{align*}
We now orient $S_{\pi}$ using the permutation:
\begin{align*}
    \sigma = \sgn{\pi} \cdot [v_0, \dots, v_d]
\end{align*}
We give an example of such an orientation in \cref{fig:orientation_of_simplicial_complex}.

We will now prove two separate claims which together yield a proof of orientability of the complex. We will first proof that all faces between two $d$-simplices are consistently oriented, and then that all lower dimensional faces inside a given simplex are consistently oriented.

\begin{claim}
    A common face $F$ of two simplices $S_1$ and $S_2$ is given opposite orientation.
\end{claim}

\begin{proof}
	Let us look at a common face $F$ of two $d$-simplices $S_1$ and $S_2$. We proceed by case distinction:
	\begin{case}{1}
		Assume that $S_1$ and $S_2$ are in the same cell, then $F$ is of the form:
		\begin{align*}
			F: \quad v_0 \xrightarrow{\pi(1)}  \cdots v_{i-1} \xrightarrow{\pi(i), \pi(i+1)} v_{i+1} \xrightarrow{\pi(i+1)} v_{i+2} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		\end{align*}
		And we have that $S_1$ and $S_2$ are of the form:
		\begin{align*}
			S_1: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i+1)} w_i \xrightarrow{\pi(i)} v_{i+1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d  \\
			S_2: \quad & v_0 \xrightarrow{\pi(1)} \cdots v_{i-1} \xrightarrow{\pi(i)} w_i' \xrightarrow{\pi(i+1)} v_{i+1} \xrightarrow{\pi(i+2)} \cdots \xrightarrow{\pi(d)} v_d
		\end{align*}
		We immediately notice that $\sgn{S_1} = - \sgn{S_2}$\marginnote{By abuse of notation we will denote by $\sgn{S_1}$ the sign of the permutation inducing $S_1$.}. We remove a vertex $w_i, w_i'$ of the same rank in $S_1$ and $S_2$ to obtain $F$. Hence, the induced orientation of $F$ in $S_1$ and $S_2$ is the opposite.
	\end{case}
	\begin{case}{2}
		Next assume that $S_1$ and $S_2$ are in neighboring cells, then as discussed in \cref{rem:faces_of_simplex} $F$ is of the form:
		\begin{align*}
			F: \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1}
		\end{align*}
		And we have that $S_1$ and $S_2$ are of the form:
		\begin{align*}
			S_1: & \quad v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \xrightarrow{\pi(d)} w_d \\
			S_2: & \quad w_0 \xrightarrow{\pi(d)} v_0 \xrightarrow{\pi(1)} v_1 \xrightarrow{\pi(2)} \cdots \xrightarrow{\pi(d-1)} v_{d-1} \\
		\end{align*}
		Once again, we must proceed by case distinction.
		\begin{case}{2.1}
			If $d$ is even, then: $\sgn{S_1} = - \sgn{S_2}$, and we remove a vertex of rank $d$ in $S_1$ and of rank $0$ in $S_2$ to obtain $F$. We have $(-1)^d = (-1)^0 = 1$ and hence the induced orientation of $F$ in $S_1$ and $S_2$ are opposite.
		\end{case}
		\begin{case}{2.2}
			If $d$ is odd, then $\sgn{S_1} = \sgn{S_2}$, and we remove a vertex of rank $d$ in $S_1$ and of rank $0$ in $S_2$ to obtain $F$. We have $(-1)^d = -1$ and $(-1)^0 = 1$ and hence the induced orientation of $F$ in $S_1$ and $S_2$ are opposite.
		\end{case}
	\end{case}
	This is the first half of the proposition
\end{proof}

 Now if we consider every $d$ as a simplicial complex of $d-1$-simplices (its faces) oriented with the induced orientations of faces we need to show that we get a consistent orientation. That is, for every $d-2$-simplex $E$, which is a face of two $d-1$-simplices $F_1$ and $F_2$, the induced orientations of $E$ in $F_1$ and $F_2$ are opposite.

\begin{claim}
	\label{claim:opposite_orientations}
	Let $F_1$ and $F_2$ be two $d-1$-simplices in $S$ which share a common face $E$. Then the induced orientations of $E$ in $S_1$ and $S_2$ are opposite.
\end{claim}
\begin{proof}
	Let $[v_0, \dots, v_{d}]$ be an orientation of $S$. The face $E$ is obtained by removing two vertices $v_i, v_j$ from $S$. Without loss of generality, assume that $F_1$ is obtained by removing $v_i$ from $S$ and $F_2$ is obtained by removing $v_j$ from $S$. Then the induced orientations $S_1$ and $S_2$ are:
	\begin{align*}
		S_1: \quad & (-1)^i \cdot [v_0, \dots, \hat{v_i}, \dots, v_{d}] \\
		S_2: \quad & (-1)^j \cdot [v_0, \dots, \hat{v_j}, \dots, v_{d}]
	\end{align*}
	Now without loss of generality assume that $i < j$, then we have that the induced orientations of $E$ in $F_1$ and $F_2$ are:
	\begin{align*}
		\text{$E$ in $S_1$ }: \quad & (-1)^i \cdot (-1)^{j-1} \cdot [v_0, \dots, \hat{v_i}, \dots, \hat{v_j}, \dots, v_{d-1}] \\
		\text{$E$ in $S_2$ }: \quad & (-1)^j \cdot (-1)^i \cdot [v_0, \dots, \hat{v_i}, \dots, \hat{v_j}, \dots, v_{d-1}]
	\end{align*}
	This shows that the induced orientations of $E$ in $S_1$ and $S_2$ are opposite.
\end{proof}

The two claims, together prove \cref{prop:orientability_freudenthal}

The second claim is a very neat little fact, as it will allow us to consider lower dimensional simplicial complexes it the following --- like for instance sequences of faces --- and argue that they are consistently oriented.

Now that we have shown that the Freudenthal decomposition is orientable, we want to discuss how it can be extended to colored simplices in the next section.

\subsection{Orienting colored simplices}[Colored orientations]

In the previous sections, we discussed how one could orient simplices. We now want to discuss the orientation of colored faces. We are only interested in rainbow faces, i.e.~$d-1$-dimensional faces, colored with all colors $\set{0, \dots, d-1}$, as these are the faces that we traverse when reducing \Sperner\ to \EndOfLine. We should obtain two orientations for every face, depending on the direction in which we traverse it.

\begin{definition}[Orientation of colored faces]
	Let $F$ be a face of a simplex $S$. Let the vertices of $F$ be labelled $v_1, \dots, v_d$, such that $v_1 < \cdots < v_d$. Then there is a permutation $\gamma \in S_d$ such that:
	\begin{align*}
		c(v_{\gamma(1)}) < c(v_{\gamma(2)}) < \cdots < c(v_{\gamma(d)})
	\end{align*}
	Then with $\sigma_F$ the induced orientation of $F$ in $S$, the orientation of the colored face $F$ is:
	\begin{align*}
		\orient_S(F) = \sgn{\gamma} \cdot \sgn{\sigma_F}
	\end{align*}
\end{definition}

Let us check that our definition is sound. We want the orientation of a face $F$ to be opposite when traversing it from opposite sides. This is the content of the following lemma.

\begin{lemma}[Colored orientations are well-defined]
	\label{lem:soundness_of_colored_orientability}
	Let $S_1$ and $S_2$ be two $d$-dimensional simplices that share a $d-1$-dimensional rainbow face $F$. Then:
	\begin{align*}
		\orient_{S_1}(F) = - \orient_{S_2}(F).
	\end{align*}
\end{lemma}
\begin{proof}
	Because the simplicial complex we work with is orientable, for $\indorient_{S_1}(F)$ the induced orientation of $F$ in $S_1$ and \boxmarginnote{The induced orientation $\indorient$, is the same as the induced orientation of faces we previously discussed instead that we work with colors and not individual vertices, this allows us to compare the induced orientations of faces which dont contain the same vertices, but the same colors.}$\indorient_{S_2}(F)$ the induced orientation of $F$ in $S_2$, we have:
	\begin{align*}
		\sgn{\indorient_{S_1}(F)} = - \sgn{\indorient_{S_2}(F)}
	\end{align*}
	This immediately implies the desired result.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Properties of colored of oriented simplicial sequences
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Properties of colored of oriented simplicial sequences}

\subsection{General properties of the coloring}

\marginnote{Recall that the coloring was given by: \begin{align*}
		c(x) =
		\begin{cases}
			0 & \text{if $x \leq f(x)$}         \\
			1 & \text{else if $x[1] > f(x)[1]$} \\
			  & \vdots                          \\
			d & \text{else if $x[d] > f(x)[d]$}
		\end{cases}
	\end{align*}}
For this section, we assume that we are working on an integer lattice $L$, and that for a function $f: L \rightarrow L$, the points have been colored $c : L \rightarrow \set{0, \dots, d}$ as in \cref{sec:tarskistar_to_sperner}. We are ready to present a first observation, which will be a helpful stepping stone for more advanced results.

\begin{lemma}
	\label{lem:monotone_coloring}
	Assume that $f$ is monotone and that we have $x_i, x_j \in L$, $c(x_i) = i$ and $c(x_j) = j$ for $i, j \in \set{1, \dots, d}$ and $x_i[i] = x_j[i]$, then either:
	\begin{enumerate}
		\item $i \geq j$ or
		\item $i < j$ and $x_i \not\geq x_j$
	\end{enumerate}
\end{lemma}
\begin{proof}
	Assume that $i < j$ and $x_i \geq x_j$. We must then have $f(x_j)[i] \geq x_j[i] = x_i[i] > f(x_i)[i]$. Now by monoticity of $f$ we must have $f(x_i) \geq f(x_j)$, which is not possible if $f(x_j)[i] > f(x_i)[i]$. Hence, we must have $x_i \not\geq x_j$. This shows that the lemma holds.
\end{proof}

For vertices of a given simplex, we get the following corollary.
\marginnote[10mm]{Notice that if we assume that $x_i$ and $x_j$ are in the same simplex of the simplicial decomposition, then the condition $x_i \not\geq x_j$ is equivalent to $x_i \leq x_j$.}
\begin{corollary}
	\label{cor:monotone_coloring}
	Assume that $f$ is monotone and that we have $x_i, x_j \in S$, for some simplex $S\in \mathcal{S}$. Further assume that $c(x_i) = i$ and $c(x_j) = j$ for $i, j \in \set{1, \dots, d}$ with $i < j$ and that $x_i[i] = x_j[i]$, then $x_i < x_j$.
\end{corollary}
\begin{proof}
	$x_i \leq x_j$, follows immediately. Because $x_i$ and $x_j$ are colored differently, they can not be equal, which shows the strict inequality.
\end{proof}

\subsection{Properties of sequences of simplices}

Now, we want to work with sequences of simplices and show that the coloring of the vertices of these simplices has some nice properties. We start by defining what we mean by a sequence of simplices. Let $C = \{0, \dots, d-1\}$ be the subset of colors, and let $\left(S_i\right)_{i=1}^k$ be a valid simplicial sequence.
\begin{lemma}
	Let $S_i$, $F_i$, and $x_j$ be as above. For any $i \in \set{1, \dots, k-1}$ there is exactly one $j \in C$ such that we have $x_i^j \neq x_{i+1}^j$.
\end{lemma}
\begin{proof}
	$F_i$ and $F_{i+1}$ are two faces of the same $d$ dimensional simplex, and thus they share exactly $d-1$ vertices. This means that there is exactly one vertex $x$ which is in $F_i$ but not in $F_{i+1}$, and exactly one vertex $y$ which is in $F_{i+1}$ but not in $F_i$. This means that there is exactly one $j$ such that $x_i^j = x$ and $x_{i+1}^j = y$.
\end{proof}

\begin{lemma}[Orientation of transition faces]
	\label{lem:consistent_orientation_of_transition_faces}
	\boxmarginnote{This means that our definition of the orientation of colored faces makes sense: when we walk through these faces, we always walk through faces that are oriented in the same way.}
	Let $\left(S_i\right)_{i=1}^{k}$ be a valid rainbow simplicial sequence. Then $\left(\orient_{S_i}(F_i)\right)_{i=1}^{k-1}$ is constant.
\end{lemma}

\begin{proof}
	It suffices to show that for all $i \in \set{1, \dots, k-2}$:
	\begin{align*}
		\orient_{S_i}(F_i) =  \orient_{S_{i+1}}(F_{i+1})
	\end{align*}
	Fix $i$, and notice that $F_i$ and $F_{i+1}$ are both faces of $S_{i+1}$. Let us label the vertices of $S_i$ $v_0 < v_1 < \dots < v_d$. Let us denote $k$ and $j$ such that $F_i$ is obtained by removing $v_k$ from $S_{i+1}$ and $F_{i+1}$ is obtained by removing $v_j$ from $S_{i+1}$.
	By using \cref{claim:opposite_orientations} and noticing that $v_k$ and $v_j$ have the same color  we immediately get:
	\begin{align*}
		- \orient_{S_{i+1}}(F_i) =  \orient_{S_{i+1}}(F_{i+1})
	\end{align*}
	Now by using \cref{lem:soundness_of_colored_orientability} we get:
	\begin{align*}
		\orient_{S_i}(F_i) = - \orient_{S_{i+1}}(F_i) =  \orient_{S_{i+1}}(F_{i+1})
	\end{align*}
	This is the desired result and concludes the proof.
\end{proof}

Before we start, we want to make an observation about the interplay of the $d$ dimension and the orientation of the simplex.
\begin{lemma}
	\label{lem:position_of_d_in_simplex}
	Let $l \in \set{1, \dots, d-1}$ be a dimension. Let $S$ be a $d$-simplex with colors $C = \set{0, \dots, d-1}$ in the colored simplicial complex, such that $S$ is of the form:
	\begin{align*}
		(S): \quad v_0 \xrightarrow{l} v_1 \xrightarrow{} \cdots \xrightarrow{} v_d
	\end{align*}
	and assume that the face $F$ spanned by $v_1, \dots, v_d$ is a rainbow face. Then the following must hold for the colors:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{}  \cdots \xrightarrow{d} \cdots  0 \xrightarrow{} \cdots \xrightarrow{} c(v_d)
	\end{align*}
\end{lemma}
\begin{proof}
	Every color $c \in \set{0, \dots, d-1}$ appears exactly once in the face $F$. If the color $c \neq 0$ appears after $0$, then by \cref{cor:monotone_coloring} we must have that we move in dimension $c$ between $0$ and $c$:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{} \cdots  0 \xrightarrow{} \cdots \xrightarrow{c} \cdots \xrightarrow{} c
	\end{align*}
	Because we have this for every color $c_i \neq 0$, which appears after $0$ in $F$ we must have:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{} \cdots  0 \xrightarrow{c_1} c_1 \xrightarrow{c_2} c_2 \cdots \xrightarrow{c_k} c_k
	\end{align*}
	Now, it is clear that because no vertex is colored with $d$, we must have that the change in dimension $d$ occurs before the vertex colored $0$ appears. This shows that we must have:
	\begin{align*}
		(F): \quad c(v_1) \xrightarrow{}  \cdots \xrightarrow{d} \cdots  0 \xrightarrow{} \cdots \xrightarrow{} c(v_d)
	\end{align*}
	This shows the lemma.
\end{proof}

\begin{lemma}[Ordering of the vertices in transition faces]
	\label{lem:ordering_of_vertices_in_transition_faces}
	Let $\left(S_i\right)_{i=1}^k$ be a valid rainbow simplicial sequence. For all $i$ such that $F_i$ is a face between cells\boxmarginnote{A face between cells is a face of type (2) in \cref{rem:faces_of_simplex}.} then assume that we are moving in dimension $l \in \set{1, \dots, d-1}$, that is $l$ is not a dimension of $F_i$. Then for all colors $c \in \set{k+1, \dots, d-1} \cup \set{0}$, we have that $c$ appears after $l$ in $F_i$. This means that $F_i$ is of the form:
	\begin{align*}
		(F_i): \quad c(v_1) \xrightarrow{} \cdots \xrightarrow{} l \xrightarrow{} \cdots \xrightarrow{} c \xrightarrow{} \cdots \xrightarrow{} c(v_d)
	\end{align*}
\end{lemma}
\begin{proof}
	Assume for the sake of contradiction that for $c \in \set{k+1, \dots, d-1} \cup \set{0}$ we have that $c$ appears before $l$ in $F_i$. Then, by \cref{cor:monotone_coloring}, we must move in dimension $l$ between $l$ and $c$. However, the dimension $l$ is not a dimension of $F_i$. This is a contradiction and shows the lemma.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%No cycles in End of Line instances
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{No cycles in the \EndOfLine\ instance}[No cycles in the \EndOfLine\ instance]

\begin{remark}
	Assume that we have a valid colored simplicial sequence that crosses a hyperplane obtained by fixing one dimension $H = L_{k = K}$, for a dimension $k \in \set{1, \dots, d}$ and $K \in [N]$, twice. Let $F_i$ and $F_j$ be the transition faces which cross the hyperplane. Then: \boxmarginnote{This means that when looking at the hyperplane from any side, $F_i$ and $F_j$ have opposite orientations.}
	\begin{align*}
		\orient_{S_i}(F_i) = - \orient_{S_{j+1}}(F_j)
	\end{align*}
\end{remark}
\begin{proof}
	This is a reformulation of the more general \cref{lem:consistent_orientation_of_transition_faces}.
\end{proof}

Now, we are ready to prove our main result. We will start by proving that there are no cycles in the three-dimensional case and then extend this to the general case.

\begin{theorem}[No cycles in three-dimensional \Tarskistar]
	\label{thm:no_cycles_in_three_dimensional_tarskistar}
	There are no cycles in the \EndOfLine\ instance which we reduce three dimensional \Tarskistar\ instances to.
\end{theorem}
\begin{proof}
	Assume for the sake of contradiction that we have a cycle in the \EndOfLine\ instance. Let $\left(S_i\right)_{i=1}^k$ be a cycle of simplices for colors $C = \set{0, 1, 2}$, and $\left(F_i\right)_{i=1}^k$ be the rainbow transition faces. We will show that this leads to a contradiction. \par

	Consider the faces $L_i^{c}$ which are the faces spanned by vertices colored not $c$ in $S_i$. Formally:
	\begin{align*}
		L_i^c & = \set{v \in S_i \mid c(v) \neq c} \quad \text{for $c \in C$}
	\end{align*}
	Notice that these $L_i^c$'s and are always either 2-dimensional or 1-dimensional simplices. Now for the sake of simplicity assume that we remove all 1-dimensional edges from these sequences, and only consider the 2-dimensional faces. Notice that this is in itself a valid oriented simplicial sequence, and in particular a cycle.

	This means that we have three cycles of faces. Now for each of these face sequences we look at the transion edges $\left(Q_i^c\right)_i$ of $\left(L_i^c \right)_i$\marginnote{Recall that this means that:
		\begin{align*}
			Q_i^c = L_i^c \cap L_{i+1}^c
		\end{align*}}.
	We then have that by \cref{lem:consistent_orientation_of_transition_faces} that the orientations of the sequence $\left(Q_i^c\right)_i$ is constant.

	We will first argue that $\left(S_i\right)_{i=1}^k$ cannot only move in two dimensions. Assume for the sake of contradiction that this is the case. TODO: Write this argument, maybe as a seperate Lemma.

	This means that any cycle must move in all 3 dimensions and in particular cross a hyperplane $H_1$ obtained by fixing dimension 1, and a hyperplane $H_2$ obtained by fixing dimension 2 at least twice. Let $F_i$ and $F_j$ be the transition faces which cross the hyperplane $H_1$ and $M_i$ and $M_j$ be the transition faces which cross the hyperplane $H_2$. Then by the remark above we have that:
	\begin{align*}
		\orient_{S_i}(F_i) = - \orient_{S_{j+1}}(F_j) \quad \text{and} \quad \orient_{S_i}(M_i) = - \orient_{S_{j+1}}(M_j)
	\end{align*}
	\marginnote{This means that when looking at these hyperplanes from any side, the transition faces have opposite orientations.}
	Now first notice, that because we have fixed dimension 1, in both $F_i$ and $F_j$, we must have that the vertex colored 0 is larger than the vertex colored 1, by \cref{cor:monotone_coloring}. Now of course these two eges are on the cycle $(L_i^2)_i$,

	\begin{case}{1}
		If we move in dimension 1 then, let $H$ be a hyperplane obtained by fixing dimension 1 which we cross twice. Then let $Q_i$ and $Q_j$ be the transition faces which cross the hyperplane. Then by the remark above we have that: $\orient_{S_i}(Q_i) = \orient_{S_j}(Q_j)$, which means that for either $Q_i$ or $Q_j$, we have that the vertex colored $1$ is larger than the vertex colored $2$. This is not possible because we do not move in dimension 1 between these two vertices. This contradicts monotonicity by \cref{cor:monotone_coloring}.
	\end{case}
	\begin{case}{2}
		If we move in dimensions 2 then, let $H$ be a hyperplane obtained by fixing dimension 2 which we cross twice. Then let $M_i$ and $M_j$ be the transition faces which cross the hyperplane. Then by the remark above we have that: $\orient_{S_i}(M_i) = \orient_{S_j}(M_j)$, which means that for either $M_i$ or $M_j$, we have that the vertex colored $2$ is larger than the vertex colored $0$. This is not possible because we do not move in dimension 2 between these two vertices. This contradicts monotonicity by \cref{cor:monotone_coloring}
	\end{case}
	Because we will always move in at least dimension 1 or 2 this concludes the proof.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Discussing the EOPL Reduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discussing the reduction of \Tarskistar\ to \EndOfPotentialLine}[Discussing the reduction to \EOPL]

We have now shown that there are no cycles in the \EndOfLine\ instance which arise from monotone \Tarskistar\ instances. This does not directly imply a direction onto \EndOfPotentialLine. Inuitively an \EndOfLine\ instance without cycles should be equivalent to an \EndOfPotentialLine\ instance. But in \EndOfPotentialLine\ the non-existence of a cycle is given by a potential which grows monotonically along the lines.

The challenge in our case is to define such a potential. We briefly want to give some inuition for why this is not easy. A first naive attempt, would be to define the potential as something similar to the sum of the coordinates of a vertex of the simplex\marginnote{Recall that this is exactly the same potential as we used to reduce \Tarski\ onto \Localopt.}. This will not work in our case though, because it can very well happen that the path though the simplicial complex is not monotone with respect to the sum of the coordinates, in particular we can cross a hyperplane multiple times, which would not be possible if the sum of the coordinates was a valid potential.

This means that we need to be more creative in our definition of the potential. The idea is to decide on how we orient our potential locally. We start by giving every cell of the simplicial complex coordinates, these will be the coordinates of the smallest vertex of cell. Now look at the colors of the vertices of the cell.