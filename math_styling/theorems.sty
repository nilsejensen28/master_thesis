\ProvidesPackage{math_styling/theorems}

%----------------------------------------------------------------------------------------
%	PACKAGE OPTIONS AND DEPENDENCIES
%----------------------------------------------------------------------------------------
\let\openbox\relax
\RequirePackage[framemethod=TikZ]{mdframed}
\RequirePackage{amsmath} % For including equations
\RequirePackage{amssymb} % For including symbols
\RequirePackage{amsthm} % For including theorems
\RequirePackage{thmtools} % For including theorems


%------------------------------------------------

% Black theorem number and optional black title padding above and below
\newtheoremstyle{blacknumbox} % Theorem style name
{0pt} % Space above
{0pt} % Space below
{\normalfont} % Body font
{} % Indent amount
{} % Theorem head font
{} % Punctuation after theorem head
{0.25em} % Space after theorem head
{\bfseries\thmname{#1}~\thmnumber{\@ifnotempty{#1}{}\@upn{#2}} % Theorem text (e.g. Theorem 2.1)
	\thmnote{\bfseries---~#3.\hspace{0.25em}}\index{#3}\newline\ignorespaces} % Optional theorem note

\newtheoremstyle{blacknumboxnoindex} % Theorem style name
{0pt} % Space above
{0pt} % Space below
{\normalfont} % Body font
{} % Indent amount
{} % Theorem head font
{} % Punctuation after theorem head
{0.25em} % Space after theorem head
{\bfseries\thmname{#1}~\thmnumber{\@ifnotempty{#1}{}\@upn{#2}} % Theorem text (e.g. Theorem 2.1)
	\thmnote{\bfseries---~#3.\hspace{0.25em}}\newline\ignorespaces} % Optional theorem note

%------------------------------------------------

% Black theorem number and optional black title with padding above and below
\theoremstyle{blacknumbox}
\newtheorem{definitionT}{Definition}[chapter]%}{Definition}[chapter] % Definitions, the first argument is the theorem name, the second the theorem title used before the number and the third optional argument is whether to number under chapters (e.g. 2.1) or sections (e.g. 2.1.1)
\theoremstyle{blacknumboxnoindex}
\newtheorem{theoremT}[definitionT]{Theorem}
\newtheorem{claimT}[definitionT]{Claim}
\newtheorem{lemmaT}[definitionT]{Lemma}
\newtheorem{corollaryT}[definitionT]{Corollary}
\newtheorem{propositionT}[definitionT]{Proposition}
\newtheorem{remarkT}[definitionT]{Remark}

%----------------------------------------------------------------------------------------
%	COLORED THEOREM BOXES
%----------------------------------------------------------------------------------------

\RequirePackage{tcolorbox} % Required for colored boxes

\newlength{\theoremboxmargin}
\setlength{\theoremboxmargin}{6pt}

% Definition box
\newtcolorbox{dBox}{colback=gray!20!white,colframe=white,boxrule=0.0pt,arc=4pt,boxsep=0pt,left=\theoremboxmargin,right=\theoremboxmargin,top=\theoremboxmargin,bottom=\theoremboxmargin,tcbox raise base, sharp corners, breakable}

% Lemma/Claim box
\newtcolorbox{cBox}{colback=gray!20!white,colframe=white,boxrule=0.0pt,arc=4pt,boxsep=0pt,left=\theoremboxmargin,right=\theoremboxmargin,top=\theoremboxmargin,bottom=\theoremboxmargin,tcbox raise base, sharp corners, breakable}

% Theorem/Corollary/Proposition box
\newtcolorbox{tBox}{colback=gray!20!white,colframe=white,boxrule=0.0pt,arc=4pt,boxsep=0pt,left=\theoremboxmargin,right=\theoremboxmargin,top=\theoremboxmargin,bottom=\theoremboxmargin,tcbox raise base, sharp corners, breakable}

%Problem box
\newtcolorbox{pBox}{colback=gray!20!white,colframe=white,boxrule=0.0pt,arc=4pt,boxsep=0pt,left=\theoremboxmargin,right=\theoremboxmargin,top=\theoremboxmargin,bottom=\theoremboxmargin,tcbox raise base, sharp corners}

\newtcolorbox{pLine}{  breakable,
	enhanced,
	colframe=white,
	top=0mm,
	right=0mm,
	left=1mm,
	boxrule=0pt,frame empty,
	borderline west={1pt}{0pt}{gray},
	coltitle=blue,
	colback=white,
	sharp corners}

% Proof box (gray line on the right hand side)
\tcolorboxenvironment{proof}{
	fonttitle=\bfseries,
	breakable,
	enhanced,
	colframe=white,
	top=0mm,
	right=0mm,
	left=1mm,
	boxrule=0pt,frame empty,
	borderline west={2pt}{0pt}{gray},
	coltitle=blue,
	colback=white,
	sharp corners,
	parbox=false %Makes parskip correct again.
}


\newenvironment{definition}{\begin{dBox}\begin{definitionT}}{\end{definitionT}\end{dBox}}
\newenvironment{theorem}{\begin{cBox}\begin{theoremT}}{\end{theoremT}\end{cBox}}
\newenvironment{claim}{\begin{cBox}\begin{claimT}}{\end{claimT}\end{cBox}}
\newenvironment{lemma}{\begin{cBox}\begin{lemmaT}}{\end{lemmaT}\end{cBox}}
\newenvironment{corollary}{\begin{cBox}\begin{corollaryT}}{\end{corollaryT}\end{cBox}}
\newenvironment{remark}{\begin{cBox}\begin{remarkT}}{\end{remarkT}\end{cBox}}
\newenvironment{proposition}{\begin{cBox}\begin{propositionT}}{\end{propositionT}\end{cBox}}

%----------------------------------------------------------------------------------------
%	Problem definitions
%----------------------------------------------------------------------------------------

\newcommand{\problem}[3]{
	\begin{pBox}
		{\scshape\bfseries #1}\index{#1} \par
		{\bfseries Input: } #2 \par
		{\bfseries Output: } #3
	\end{pBox}
}

%----------------------------------------------------------------------------------------
%	Case definitions
%----------------------------------------------------------------------------------------

%Environment for cases in proofs side line colored gray, and 1pt thick
\newenvironment{case}[1]{\textbf{Case #1:}}{}
\surroundwithmdframed[
	topline=false,
	rightline=false,
	bottomline=false,
	leftmargin=1pt,
	innertopmargin=0pt,
	innerbottommargin=0pt,
	innerrightmargin=0pt,
	innerleftmargin=2pt,
	linecolor=gray,
	linewidth=1pt,
	nobreak=false,
	skipabove=\medskipamount,
	skipbelow=\medskipamount,
]{case}